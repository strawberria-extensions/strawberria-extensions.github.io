import{s as Te,R as tt,e as k,c as C,b as w,f as u,p as o,i as P,S as st,T as lt,U as it,o as je,V as at,u as ze,r as rt,a as L,t as Z,x as ee,g as V,d as Q,y as W,h as c,A as se,j as oe,n as ve,B as Se,W as A,X as K,Y as we,q as Ye,k as ke,w as _e,Z as ot,C as Ie,l as Ge,D as nt}from"../chunks/scheduler.116f4462.js";import{S as Me,i as De,a as re,t as ue,c as Ae,g as Ke,f as ct,b as Xe,d as Ze,m as Qe,e as $e}from"../chunks/index.e73769d8.js";import{h as ft,s as ut,e as Oe}from"../chunks/utility.24615bb2.js";import{w as Ce}from"../chunks/index.dd94c52f.js";import{b as dt}from"../chunks/_commonjsHelpers.573e169a.js";import{J as et}from"../chunks/puzzle.1dd5b8cd.js";import"../chunks/nunjucks.70065508.js";const ht=!0,Vt=Object.freeze(Object.defineProperty({__proto__:null,prerender:ht},Symbol.toStringTag,{value:"Module"}));function gt(l){let e,t,s,r;const f=l[8].default,i=tt(f,l,l[7],null);return{c(){e=k("div"),i&&i.c(),this.h()},l(a){e=C(a,"DIV",{class:!0,style:!0});var n=w(e);i&&i.l(n),n.forEach(u),this.h()},h(){o(e,"class",t=`__grid--masonry ${l[0]?"__stretch-first":""}`),o(e,"style",s=`--grid-gap: ${l[1]}; --col-width: ${l[2]};`)},m(a,n){P(a,e,n),i&&i.m(e,null),l[9](e),r=!0},p(a,[n]){i&&i.p&&(!r||n&128)&&st(i,f,a,a[7],r?it(f,a[7],n,null):lt(a[7]),null),(!r||n&1&&t!==(t=`__grid--masonry ${a[0]?"__stretch-first":""}`))&&o(e,"class",t),(!r||n&6&&s!==(s=`--grid-gap: ${a[1]}; --col-width: ${a[2]};`))&&o(e,"style",s)},i(a){r||(re(i,a),r=!0)},o(a){ue(i,a),r=!1},d(a){a&&u(e),i&&i.d(a),l[9](null)}}}function pt(l,e,t){let{$$slots:s={},$$scope:r}=e,{stretchFirst:f=!1,gridGap:i="0.5em",colWidth:a="minmax(Min(20em, 100%), 1fr)",items:n=[]}=e,m=[],x,{reset:b}=e;const d=async()=>{m.forEach(async h=>{let p=getComputedStyle(h._el).gridTemplateColumns.split(" ").length;h.items.forEach(E=>{let D=E.getBoundingClientRect().height;D!==+E.dataset.h&&(E.dataset.h=D,h.mod++)}),(h.ncol!==p||h.mod)&&(h.ncol=p,h.items.forEach(E=>E.style.removeProperty("margin-top")),h.ncol>1&&h.items.slice(p).forEach((E,D)=>{let G=h.items[D].getBoundingClientRect().bottom,v=E.getBoundingClientRect().top;E.style.marginTop=`${G+h.gap-v}px`}),h.mod=0)})},_=async h=>{await rt(),h.length&&getComputedStyle(h[0]).gridTemplateRows!=="masonry"&&(m=h.map(p=>({_el:p,gap:parseFloat(getComputedStyle(p).gridRowGap),items:[...p.childNodes].filter(E=>E.nodeType===1&&+getComputedStyle(E).gridColumnEnd!=-1),ncol:0,mod:0})),d())};let g;je(()=>{g=window,g.addEventListener("resize",d,!1)}),at(()=>{g&&g.removeEventListener("resize",d,!1)});function I(h){ze[h?"unshift":"push"](()=>{x=h,t(3,x),t(5,b),t(4,n)})}return l.$$set=h=>{"stretchFirst"in h&&t(0,f=h.stretchFirst),"gridGap"in h&&t(1,i=h.gridGap),"colWidth"in h&&t(2,a=h.colWidth),"items"in h&&t(4,n=h.items),"reset"in h&&t(5,b=h.reset),"$$scope"in h&&t(7,r=h.$$scope)},l.$$.update=()=>{l.$$.dirty&40&&b&&(t(3,x),t(5,b),t(4,n)),l.$$.dirty&24&&n&&(t(3,x),t(5,b),t(4,n)),l.$$.dirty&8&&x&&_([x])},[f,i,a,x,n,b,d,r,s,I]}class mt extends Me{constructor(e){super(),De(this,e,pt,gt,Te,{stretchFirst:0,gridGap:1,colWidth:2,items:4,reset:5,refreshLayout:6})}get refreshLayout(){return this.$$.ctx[6]}}function _t(l){let e,t,s,r,f,i,a,n,m,x="Restart",b,d,_="Main Menu",g,I;return{c(){e=k("div"),t=k("div"),s=k("div"),r=k("div"),f=Z(`Jigsaw puzzle completed! \r
                        Time elapsed: `),i=Z(l[3]),a=L(),n=k("div"),m=k("button"),m.textContent=x,b=L(),d=k("button"),d.textContent=_,this.h()},l(h){e=C(h,"DIV",{class:!0,style:!0});var p=w(e);t=C(p,"DIV",{class:!0});var E=w(t);s=C(E,"DIV",{class:!0});var D=w(s);r=C(D,"DIV",{class:!0});var G=w(r);f=Q(G,`Jigsaw puzzle completed! \r
                        Time elapsed: `),i=Q(G,l[3]),G.forEach(u),D.forEach(u),a=V(E),n=C(E,"DIV",{class:!0});var v=w(n);m=C(v,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(m)!=="svelte-1i6z1dz"&&(m.textContent=x),b=V(v),d=C(v,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(d)!=="svelte-10ck3c"&&(d.textContent=_),v.forEach(u),E.forEach(u),p.forEach(u),this.h()},h(){o(r,"class","text-xl"),o(s,"class","flex flex-col items-center justify-center"),o(m,"class","bg-gray-600 p-2 px-4 rounded-[0.5em] hover:bg-gray-500 text-xl"),o(d,"class","bg-gray-600 p-2 px-4 rounded-[0.5em] hover:bg-gray-500 text-xl"),o(n,"class","flex flex-row space-x-[1em]"),o(t,"class","flex flex-col items-center p-5 bg-gray-800 !opacity-100 space-y-[1.5em] rounded-lg border-gray-600 border-2"),o(e,"class","absolute top-0 left-0 w-full h-full flex flex-col items-center justify-center"),Ye(e,"background-color","rgb(31 41 55 / 0.85)")},m(h,p){P(h,e,p),c(e,t),c(t,s),c(s,r),c(r,f),c(r,i),c(t,a),c(t,n),c(n,m),c(n,b),c(n,d),g||(I=[se(m,"click",l[15]),se(d,"click",l[16])],g=!0)},p(h,p){p&8&&oe(i,h[3])},d(h){h&&u(e),g=!1,Se(I)}}}function vt(l){let e,t,s,r="<div>Are you sure you want to restart?</div>",f,i,a,n="Restart",m,x,b="Cancel",d,_;return{c(){e=k("div"),t=k("div"),s=k("div"),s.innerHTML=r,f=L(),i=k("div"),a=k("button"),a.textContent=n,m=L(),x=k("button"),x.textContent=b,this.h()},l(g){e=C(g,"DIV",{class:!0,style:!0});var I=w(e);t=C(I,"DIV",{class:!0});var h=w(t);s=C(h,"DIV",{class:!0,"data-svelte-h":!0}),ee(s)!=="svelte-pst40z"&&(s.innerHTML=r),f=V(h),i=C(h,"DIV",{class:!0});var p=w(i);a=C(p,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-ybdh3d"&&(a.textContent=n),m=V(p),x=C(p,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(x)!=="svelte-erk6gn"&&(x.textContent=b),p.forEach(u),h.forEach(u),I.forEach(u),this.h()},h(){o(s,"class","flex flex-col items-center justify-center"),o(a,"class","bg-gray-600 p-2 px-4 rounded-[0.5em] hover:bg-gray-500"),o(x,"class","bg-gray-600 p-2 px-4 rounded-[0.5em] hover:bg-gray-500"),o(i,"class","flex flex-row space-x-[1em]"),o(t,"class","flex flex-col items-center p-5 bg-gray-800 !opacity-100 space-y-[1em] rounded-lg border-gray-600 border-2"),W(t,"text-xl",!l[4]),o(e,"class","absolute top-0 left-0 w-full h-full flex flex-col items-center justify-center"),Ye(e,"background-color","rgb(31 41 55 / 0.85)")},m(g,I){P(g,e,I),c(e,t),c(t,s),c(t,f),c(t,i),c(i,a),c(i,m),c(i,x),d||(_=[se(a,"click",l[13]),se(x,"click",l[14])],d=!0)},p(g,I){I&16&&W(t,"text-xl",!g[4])},d(g){g&&u(e),d=!1,Se(_)}}}function Pe(l){let e=l[0].display+"",t,s,r=l[0].rowColsRatio[0]*l[0].rowColsRatio[1]+"",f,i,a,n,m,x,b,d,_,g,I,h;return{c(){t=Z(e),s=Z(" ｜"),f=Z(r),i=L(),a=A("svg"),n=A("defs"),m=A("path"),x=A("linearGradient"),b=A("stop"),d=A("stop"),_=A("clipPath"),g=A("use"),I=A("use"),h=Z("｜"),this.h()},l(p){t=Q(p,e),s=Q(p," ｜"),f=Q(p,r),i=V(p),a=K(p,"svg",{class:!0,viewBox:!0,xmlns:!0,"xmlns:xlink":!0});var E=w(a);n=K(E,"defs",{});var D=w(n);m=K(D,"path",{id:!0,d:!0}),w(m).forEach(u),x=K(D,"linearGradient",{id:!0,gradientTransform:!0});var G=w(x);b=K(G,"stop",{offset:!0,"stop-color":!0}),w(b).forEach(u),d=K(G,"stop",{offset:!0,"stop-color":!0}),w(d).forEach(u),G.forEach(u),_=K(D,"clipPath",{id:!0});var v=w(_);g=K(v,"use",{"xlink:href":!0,href:!0}),w(g).forEach(u),v.forEach(u),D.forEach(u),I=K(E,"use",{"xlink:href":!0,href:!0,fill:!0,"clip-path":!0,stroke:!0,"stroke-opacity":!0,"stroke-width":!0}),w(I).forEach(u),E.forEach(u),h=Q(p,"｜"),this.h()},h(){o(m,"id","pp"),o(m,"d","M9.373,9.373C25.59,14.161,28.988,12.384,25.976,7.983C19.953-0.821,44.047-0.821,38.024,7.983C35.012,12.384,38.41,14.161,54.627,9.373C59.415,25.59,57.639,28.988,53.237,25.976C44.433,19.953,44.433,44.047,53.237,38.024C57.639,35.012,59.415,38.41,54.627,54.627C38.41,49.839,35.012,51.616,38.024,56.017C44.047,64.821,19.953,64.821,25.976,56.017C28.988,51.616,25.59,49.839,9.373,54.627C4.585,38.41,6.361,35.012,10.763,38.024C19.567,44.047,19.567,19.953,10.763,25.976C6.361,28.988,4.585,25.59,9.373,9.373z"),o(b,"offset","0%"),o(b,"stop-color","#f6f6f6"),o(d,"offset","100%"),o(d,"stop-color","#eee"),o(x,"id","grr"),o(x,"gradientTransform","rotate(90)"),we(g,"xlink:href","#pp"),o(g,"href","#pp"),o(_,"id","cl"),we(I,"xlink:href","#pp"),o(I,"href","#pp"),o(I,"fill","url(#grr)"),o(I,"clip-path","url(#cl)"),o(I,"stroke","#000"),o(I,"stroke-opacity","0.4"),o(I,"stroke-width","2.0"),o(a,"class","h-6 aspect-square ml-[0.125em] mb-[0.125em]"),o(a,"viewBox","0 0 64 64"),o(a,"xmlns","http://www.w3.org/2000/svg"),o(a,"xmlns:xlink","http://www.w3.org/1999/xlink")},m(p,E){P(p,t,E),P(p,s,E),P(p,f,E),P(p,i,E),P(p,a,E),c(a,n),c(n,m),c(n,x),c(x,b),c(x,d),c(n,_),c(_,g),c(a,I),P(p,h,E)},p(p,E){E&1&&e!==(e=p[0].display+"")&&oe(t,e),E&1&&r!==(r=p[0].rowColsRatio[0]*p[0].rowColsRatio[1]+"")&&oe(f,r)},d(p){p&&(u(t),u(s),u(f),u(i),u(a),u(h))}}}function wt(l){let e,t,s="",r,f,i,a,n,m='<i class="fas fa-arrow-left text-center px-2"></i>',x,b,d='<i class="fas fa-power-off text-center px-2"></i>',_,g,I='<i class="fas fa-random text-center px-2"></i>',h,p,E,D,G,v,j,z,U,R,S,y,B,$,F,ne,de;function ie(T,M){if(T[5]===!0)return vt;if(T[6]===!0)return _t}let te=ie(l),H=te&&te(l),J=!l[4]&&Pe(l);return{c(){e=k("div"),t=k("div"),t.innerHTML=s,r=L(),H&&H.c(),f=L(),i=k("div"),a=k("div"),n=k("button"),n.innerHTML=m,x=L(),b=k("button"),b.innerHTML=d,_=L(),g=k("button"),g.innerHTML=I,h=L(),p=k("div"),J&&J.c(),E=L(),D=Z(l[3]),G=L(),v=k("div"),j=k("button"),z=k("i"),S=L(),y=k("button"),B=k("i"),this.h()},l(T){e=C(T,"DIV",{class:!0});var M=w(e);t=C(M,"DIV",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-13qt7ec"&&(t.innerHTML=s),r=V(M),H&&H.l(M),M.forEach(u),f=V(T),i=C(T,"DIV",{class:!0});var le=w(i);a=C(le,"DIV",{class:!0});var O=w(a);n=C(O,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(n)!=="svelte-1rhygxs"&&(n.innerHTML=m),x=V(O),b=C(O,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(b)!=="svelte-1rsd63d"&&(b.innerHTML=d),_=V(O),g=C(O,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(g)!=="svelte-ydd0ao"&&(g.innerHTML=I),O.forEach(u),h=V(le),p=C(le,"DIV",{class:!0});var N=w(p);J&&J.l(N),E=V(N),D=Q(N,l[3]),N.forEach(u),G=V(le),v=C(le,"DIV",{class:!0});var q=w(v);j=C(q,"BUTTON",{class:!0});var Y=w(j);z=C(Y,"I",{class:!0}),w(z).forEach(u),Y.forEach(u),S=V(q),y=C(q,"BUTTON",{class:!0});var ge=w(y);B=C(ge,"I",{class:!0}),w(B).forEach(u),ge.forEach(u),q.forEach(u),le.forEach(u),this.h()},h(){o(t,"class","absolute top-0 left-0 w-full h-full bg-[#2f2c3b]"),o(e,"class","relative grow shrink-0"),o(n,"class","flex flex-col justify-center cursor-pointer hover:bg-gray-600 text-slate-300"),o(b,"class","flex flex-col justify-center cursor-pointer hover:bg-gray-600 text-slate-300"),o(g,"class","flex flex-col justify-center cursor-pointer hover:bg-gray-600 text-slate-300"),o(a,"class","flex flex-row grow"),W(a,"text-3xl",!l[4]),W(a,"text-xl",l[4]),o(p,"class","flex flex-row p-[0.25em] items-center"),W(p,"text-lg",l[4]),o(z,"class","fas fa-image-polaroid text-center px-2"),o(j,"class",U=`flex flex-col justify-center ${l[0].settings.allowGhost?"cursor-pointer hover:bg-gray-600 text-slate-300":"cursor-not-allowed text-slate-500"}`),j.disabled=R=l[0].settings.allowGhost===!1,o(B,"class","fas fa-border-outer text-center px-2"),o(y,"class",$=`flex flex-col justify-center ${l[0].settings.allowEdge?"cursor-pointer hover:bg-gray-600 text-slate-300":"cursor-not-allowed text-slate-500"}`),y.disabled=F=l[0].settings.allowEdge===!1,o(v,"class","flex flex-row grow justify-end"),W(v,"text-3xl",!l[4]),W(v,"text-xl",l[4]),o(i,"class","w-full flex flex-row bg-gray-700 p-1"),W(i,"text-xl",!l[4]),W(i,"text-md",l[4])},m(T,M){P(T,e,M),c(e,t),l[12](t),c(e,r),H&&H.m(e,null),P(T,f,M),P(T,i,M),c(i,a),c(a,n),c(a,x),c(a,b),c(a,_),c(a,g),c(i,h),c(i,p),J&&J.m(p,null),c(p,E),c(p,D),c(i,G),c(i,v),c(v,j),c(j,z),c(v,S),c(v,y),c(y,B),ne||(de=[se(n,"click",l[17]),se(b,"click",l[18]),se(g,"click",l[19]),se(j,"click",l[20]),se(y,"click",l[21])],ne=!0)},p(T,[M]){te===(te=ie(T))&&H?H.p(T,M):(H&&H.d(1),H=te&&te(T),H&&(H.c(),H.m(e,null))),M&16&&W(a,"text-3xl",!T[4]),M&16&&W(a,"text-xl",T[4]),T[4]?J&&(J.d(1),J=null):J?J.p(T,M):(J=Pe(T),J.c(),J.m(p,E)),M&8&&oe(D,T[3]),M&16&&W(p,"text-lg",T[4]),M&1&&U!==(U=`flex flex-col justify-center ${T[0].settings.allowGhost?"cursor-pointer hover:bg-gray-600 text-slate-300":"cursor-not-allowed text-slate-500"}`)&&o(j,"class",U),M&1&&R!==(R=T[0].settings.allowGhost===!1)&&(j.disabled=R),M&1&&$!==($=`flex flex-col justify-center ${T[0].settings.allowEdge?"cursor-pointer hover:bg-gray-600 text-slate-300":"cursor-not-allowed text-slate-500"}`)&&o(y,"class",$),M&1&&F!==(F=T[0].settings.allowEdge===!1)&&(y.disabled=F),M&16&&W(v,"text-3xl",!T[4]),M&16&&W(v,"text-xl",T[4]),M&16&&W(i,"text-xl",!T[4]),M&16&&W(i,"text-md",T[4])},i:ve,o:ve,d(T){T&&(u(e),u(f),u(i)),l[12](null),H&&H.d(),J&&J.d(),ne=!1,Se(de)}}}function bt(l,e,t){let{jigsawConfig:s}=e,{mainMenu:r}=e,{callbackCompletedExternal:f}=e,{callbackSavedExternal:i}=e,a,n,m,x=!1;je(async()=>{t(4,x=window.innerHeight>window.innerWidth);const y="1";t(2,n=new et(s,a,y,!1)),n.elapsedTimeMSStore.subscribe(B=>{t(3,m=new Date(B).toISOString().slice(11,19))}),t(2,n.callbackCompleted=I,n),t(2,n.callbackSaved=g,n),await _(!1)});let b=!1,d=!1;async function _(y){t(5,b=!1),t(6,d=!1),y===!1&&await n.preInitialize(),await n.initializeInstance(y),await n.generateJigsawPieces()}function g(y,B,$,F){y!==void 0&&(s.rowColsRatio[0]*s.rowColsRatio[1],y.connections.length),i(y,B,$,F)}function I(y,B=!1){B===!1&&f(y),t(6,d=!0),new Date(y.elapsedMS).toISOString().slice(11,19)}function h(){n.prepMainMenu(),n.application.stage.removeChildren(),r()}function p(y){ze[y?"unshift":"push"](()=>{a=y,t(1,a)})}const E=()=>{_(!0)},D=()=>{t(5,b=!1)},G=()=>{_(!0)},v=()=>{h()},j=()=>{b||h()},z=()=>{t(5,b=!0)},U=()=>{b||n.shuffleContainers()},R=()=>{b||n.toggleGhostVisibility()},S=()=>{b||n.toggleEdgeVisibility()};return l.$$set=y=>{"jigsawConfig"in y&&t(0,s=y.jigsawConfig),"mainMenu"in y&&t(9,r=y.mainMenu),"callbackCompletedExternal"in y&&t(10,f=y.callbackCompletedExternal),"callbackSavedExternal"in y&&t(11,i=y.callbackSavedExternal)},[s,a,n,m,x,b,d,_,h,r,f,i,p,E,D,G,v,j,z,U,R,S]}class yt extends Me{constructor(e){super(),De(this,e,bt,wt,Te,{jigsawConfig:0,mainMenu:9,callbackCompletedExternal:10,callbackSavedExternal:11})}}function Ue(l,e,t){const s=l.slice();s[18]=e[t],s[23]=t;const r=s[18].rowColsRatio[0]*s[18].rowColsRatio[1];s[19]=r;const f=s[4][s[1][s[23]]]??[0,void 0];s[20]=f;const i=s[20][1]*360;return s[21]=i,s}function kt(l){let e,t,s,r=`<div class="card-content max-w-[80em]"><div class="flex flex-row space-x-1 items-end justify-between mb-2"><h4 class="mb-0">[🍓] Jigsaw Puzzles</h4> <span class="caption">Developer: <a href="https://chaster.app/user/strawberria" target="_blank">@strawberria</a></span></div> <div class="caption">Configurable jigsaw puzzles supporting rotating pieces, image &#39;ghosting&#39;, and other features! <br/>
                            • Number of pieces is automatically optimized on config creation based on target number of pieces <br/>
                            • Currently whitelisted image hosters (hotlinking and thumbnail): <a target="_blank" href="https://imgbox.com">imgbox</a>, <a target="_blank" href="https://postimages.org">postimages</a> <br/>
                            • Rotation is disabled for mobile devices until a convenient solution is found...<br/> <b class="mt-[1em]">(If you experience any performance issues especially when moving between puzzles, please refresh the page!)</b></div></div>`,f,i,a,n,m;function x(_){l[13](_)}let b={reset:!1,colWidth:"24em",gridGap:"1em",$$slots:{default:[xt]},$$scope:{ctx:l}};l[2]!==void 0&&(b.refreshLayout=l[2]),i=new mt({props:b}),ze.push(()=>ct(i,"refreshLayout",x));let d=l[3]!==void 0&&We(l);return{c(){e=k("div"),t=k("div"),s=k("div"),s.innerHTML=r,f=L(),Xe(i.$$.fragment),n=L(),d&&d.c(),this.h()},l(_){e=C(_,"DIV",{class:!0});var g=w(e);t=C(g,"DIV",{class:!0});var I=w(t);s=C(I,"DIV",{class:!0,"data-svelte-h":!0}),ee(s)!=="svelte-1ksigai"&&(s.innerHTML=r),f=V(I),Ze(i.$$.fragment,I),I.forEach(u),n=V(g),d&&d.l(g),g.forEach(u),this.h()},h(){o(s,"class","flex flex-col items-center w-full"),o(t,"class","absolute top-0 left-0 w-full flex flex-col card-wrapper-desktop space-y-[1em] h-full svelte-1xrjqdv"),o(e,"class","relative w-full h-full")},m(_,g){P(_,e,g),c(e,t),c(t,s),c(t,f),Qe(i,t,null),c(e,n),d&&d.m(e,null),m=!0},p(_,g){const I={};g&16777274&&(I.$$scope={dirty:g,ctx:_}),!a&&g&4&&(a=!0,I.refreshLayout=_[2],ot(()=>a=!1)),i.$set(I),_[3]!==void 0?d?(d.p(_,g),g&8&&re(d,1)):(d=We(_),d.c(),re(d,1),d.m(e,null)):d&&(Ke(),ue(d,1,1,()=>{d=null}),Ae())},i(_){m||(re(i.$$.fragment,_),re(d),m=!0)},o(_){ue(i.$$.fragment,_),ue(d),m=!1},d(_){_&&u(e),$e(i),d&&d.d()}}}function Ct(l){let e,t,s,r,f,i;return{c(){e=k("div"),t=k("img"),r=L(),f=k("div"),i=Z(l[0]),this.h()},l(a){e=C(a,"DIV",{class:!0});var n=w(e);t=C(n,"IMG",{src:!0,alt:!0}),r=V(n),f=C(n,"DIV",{class:!0});var m=w(f);i=Q(m,l[0]),m.forEach(u),n.forEach(u),this.h()},h(){Ie(t.src,s=dt)||o(t,"src",s),o(t,"alt","Chaster logo"),o(f,"class","mt-4 caption text-lg"),o(e,"class","w-full h-screen flex flex-col items-center justify-center")},m(a,n){P(a,e,n),c(e,t),c(e,r),c(e,f),c(f,i)},p(a,n){n&1&&oe(i,a[0])},i:ve,o:ve,d(a){a&&u(e)}}}function Be(l){let e,t=`<svg class="opacity-90" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 17.837 17.837" xml:space="preserve"><g><path style="fill:#10b981" d="M16.145,2.571c-0.272-0.273-0.718-0.273-0.99,0L6.92,10.804l-4.241-4.27
                                                        c-0.272-0.274-0.715-0.274-0.989,0L0.204,8.019c-0.272,0.271-0.272,0.717,0,0.99l6.217,6.258c0.272,0.271,0.715,0.271,0.99,0
                                                        L17.63,5.047c0.276-0.273,0.276-0.72,0-0.994L16.145,2.571z"></path></g></svg>`;return{c(){e=k("div"),e.innerHTML=t,this.h()},l(s){e=C(s,"DIV",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-11itew8"&&(e.innerHTML=t),this.h()},h(){o(e,"class","absolute h-full w-full top-0 left-0 flex flex-col justify-center p-[2em]")},m(s,r){P(s,e,r)},d(s){s&&u(e)}}}function He(l){let e,t,s=l[18].settings.rotation+"",r,f;return{c(){e=k("div"),t=Z("• Rotation enabled: "),r=Z(s),f=Z("° increments"),this.h()},l(i){e=C(i,"DIV",{class:!0});var a=w(e);t=Q(a,"• Rotation enabled: "),r=Q(a,s),f=Q(a,"° increments"),a.forEach(u),this.h()},h(){o(e,"class","caption")},m(i,a){P(i,e,a),c(e,t),c(e,r),c(e,f)},p(i,a){a&32&&s!==(s=i[18].settings.rotation+"")&&oe(r,s)},d(i){i&&u(e)}}}function Je(l){let e,t="• ⚠️ Image ghosting disabled! ⚠️";return{c(){e=k("div"),e.textContent=t,this.h()},l(s){e=C(s,"DIV",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-tbfc0w"&&(e.textContent=t),this.h()},h(){o(e,"class","caption")},m(s,r){P(s,e,r)},d(s){s&&u(e)}}}function Ne(l){let e,t="• ⚠️ Edge piece filtering disabled! ⚠️";return{c(){e=k("div"),e.textContent=t,this.h()},l(s){e=C(s,"DIV",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1e8gcfn"&&(e.textContent=t),this.h()},h(){o(e,"class","caption")},m(s,r){P(s,e,r)},d(s){s&&u(e)}}}function qe(l){let e,t,s,r,f,i,a,n,m,x,b,d,_,g,I=l[18].display+"",h,p,E,D=l[19]+"",G,v,j,z,U,R,S,y,B,$,F,ne,de,ie,te,H,J,T,M,le,O=l[20][0]===1&&Be(),N=l[18].settings.rotation%360!==0&&He(l),q=!l[18].settings.allowEdge&&Je(),Y=!l[18].settings.allowEdge&&Ne();function ge(){return l[12](l[18])}return{c(){e=k("div"),t=k("div"),s=k("div"),r=k("div"),i=L(),a=k("img"),x=L(),O&&O.c(),b=L(),d=k("div"),_=k("div"),g=k("div"),h=Z(I),p=Z(" ("),E=k("div"),G=Z(D),v=L(),j=A("svg"),z=A("defs"),U=A("path"),R=A("linearGradient"),S=A("stop"),y=A("stop"),B=A("clipPath"),$=A("use"),F=A("use"),ne=Z(")"),de=L(),ie=k("div"),te=L(),N&&N.c(),H=L(),q&&q.c(),J=L(),Y&&Y.c(),T=L(),this.h()},l(ce){e=C(ce,"DIV",{class:!0});var X=w(e);t=C(X,"DIV",{class:!0});var Le=w(t);s=C(Le,"DIV",{class:!0});var he=w(s);r=C(he,"DIV",{class:!0,style:!0}),w(r).forEach(u),i=V(he),a=C(he,"IMG",{class:!0,style:!0,src:!0}),x=V(he),O&&O.l(he),he.forEach(u),Le.forEach(u),b=V(X),d=C(X,"DIV",{class:!0});var ae=w(d);_=C(ae,"DIV",{class:!0});var pe=w(_);g=C(pe,"DIV",{class:!0});var fe=w(g);h=Q(fe,I),p=Q(fe," ("),E=C(fe,"DIV",{});var Ve=w(E);G=Q(Ve,D),Ve.forEach(u),v=V(fe),j=K(fe,"svg",{class:!0,viewBox:!0,xmlns:!0,"xmlns:xlink":!0});var be=w(j);z=K(be,"defs",{});var me=w(z);U=K(me,"path",{id:!0,d:!0}),w(U).forEach(u),R=K(me,"linearGradient",{id:!0,gradientTransform:!0});var ye=w(R);S=K(ye,"stop",{offset:!0,"stop-color":!0}),w(S).forEach(u),y=K(ye,"stop",{offset:!0,"stop-color":!0}),w(y).forEach(u),ye.forEach(u),B=K(me,"clipPath",{id:!0});var Re=w(B);$=K(Re,"use",{"xlink:href":!0,href:!0}),w($).forEach(u),Re.forEach(u),me.forEach(u),F=K(be,"use",{"xlink:href":!0,href:!0,fill:!0,"clip-path":!0,stroke:!0,"stroke-opacity":!0,"stroke-width":!0}),w(F).forEach(u),be.forEach(u),ne=Q(fe,")"),fe.forEach(u),de=V(pe),ie=C(pe,"DIV",{class:!0}),w(ie).forEach(u),pe.forEach(u),te=V(ae),N&&N.l(ae),H=V(ae),q&&q.l(ae),J=V(ae),Y&&Y.l(ae),ae.forEach(u),T=V(X),X.forEach(u),this.h()},h(){o(r,"class","absolute top-0 left-0 w-full h-full opacity-80 z-10"),o(r,"style",f=l[20][1]!==void 0&&l[20][0]>1?`background: conic-gradient(transparent ${l[21]}deg, #292833 ${l[21]}deg 360deg);`:""),o(a,"class","block h-full w-full pie"),o(a,"style",n=l[18].settings.allowGhost?"":"clip-path: inset(0 0 0 0);"),Ie(a.src,m=Fe(l[18].imageURL))||o(a,"src",m),W(a,"blur-md",!l[18].settings.allowGhost&&l[20][0]!==1),o(s,"class","relative"),o(t,"class","flex flex-col items-center"),o(U,"id","pp"),o(U,"d","M9.373,9.373C25.59,14.161,28.988,12.384,25.976,7.983C19.953-0.821,44.047-0.821,38.024,7.983C35.012,12.384,38.41,14.161,54.627,9.373C59.415,25.59,57.639,28.988,53.237,25.976C44.433,19.953,44.433,44.047,53.237,38.024C57.639,35.012,59.415,38.41,54.627,54.627C38.41,49.839,35.012,51.616,38.024,56.017C44.047,64.821,19.953,64.821,25.976,56.017C28.988,51.616,25.59,49.839,9.373,54.627C4.585,38.41,6.361,35.012,10.763,38.024C19.567,44.047,19.567,19.953,10.763,25.976C6.361,28.988,4.585,25.59,9.373,9.373z"),o(S,"offset","0%"),o(S,"stop-color","#f6f6f6"),o(y,"offset","100%"),o(y,"stop-color","#eee"),o(R,"id","gr"),o(R,"gradientTransform","rotate(90)"),we($,"xlink:href","#pp"),o($,"href","#pp"),o(B,"id","cl"),we(F,"xlink:href","#pp"),o(F,"href","#pp"),o(F,"fill","url(#gr)"),o(F,"clip-path","url(#cl)"),o(F,"stroke","#000"),o(F,"stroke-opacity","0.4"),o(F,"stroke-width","2.0"),o(j,"class","h-6 aspect-square ml-[0.125em] mb-[0.125em]"),o(j,"viewBox","0 0 64 64"),o(j,"xmlns","http://www.w3.org/2000/svg"),o(j,"xmlns:xlink","http://www.w3.org/1999/xlink"),o(g,"class","flex flex-row"),o(ie,"class","grow"),o(_,"class","flex flex-row items-center"),o(d,"class","flex flex-col items-stretch w-full text-lg"),o(e,"class","card-content space-y-[0.75em] cursor-pointer card-hover svelte-1xrjqdv"),W(e,"hidden",l[3]!==void 0)},m(ce,X){P(ce,e,X),c(e,t),c(t,s),c(s,r),c(s,i),c(s,a),c(s,x),O&&O.m(s,null),c(e,b),c(e,d),c(d,_),c(_,g),c(g,h),c(g,p),c(g,E),c(E,G),c(g,v),c(g,j),c(j,z),c(z,U),c(z,R),c(R,S),c(R,y),c(z,B),c(B,$),c(j,F),c(g,ne),c(_,de),c(_,ie),c(d,te),N&&N.m(d,null),c(d,H),q&&q.m(d,null),c(d,J),Y&&Y.m(d,null),c(e,T),M||(le=se(e,"click",ge),M=!0)},p(ce,X){l=ce,X&18&&f!==(f=l[20][1]!==void 0&&l[20][0]>1?`background: conic-gradient(transparent ${l[21]}deg, #292833 ${l[21]}deg 360deg);`:"")&&o(r,"style",f),X&32&&n!==(n=l[18].settings.allowGhost?"":"clip-path: inset(0 0 0 0);")&&o(a,"style",n),X&32&&!Ie(a.src,m=Fe(l[18].imageURL))&&o(a,"src",m),X&50&&W(a,"blur-md",!l[18].settings.allowGhost&&l[20][0]!==1),l[20][0]===1?O||(O=Be(),O.c(),O.m(s,null)):O&&(O.d(1),O=null),X&32&&I!==(I=l[18].display+"")&&oe(h,I),X&32&&D!==(D=l[19]+"")&&oe(G,D),l[18].settings.rotation%360!==0?N?N.p(l,X):(N=He(l),N.c(),N.m(d,H)):N&&(N.d(1),N=null),l[18].settings.allowEdge?q&&(q.d(1),q=null):q||(q=Je(),q.c(),q.m(d,J)),l[18].settings.allowEdge?Y&&(Y.d(1),Y=null):Y||(Y=Ne(),Y.c(),Y.m(d,null)),X&8&&W(e,"hidden",l[3]!==void 0)},d(ce){ce&&u(e),O&&O.d(),N&&N.d(),q&&q.d(),Y&&Y.d(),M=!1,le()}}}function xt(l){let e,t=Oe(l[5].jigsaws),s=[];for(let r=0;r<t.length;r+=1)s[r]=qe(Ue(l,t,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=Ge()},l(r){for(let f=0;f<s.length;f+=1)s[f].l(r);e=Ge()},m(r,f){for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(r,f);P(r,e,f)},p(r,f){if(f&58){t=Oe(r[5].jigsaws);let i;for(i=0;i<t.length;i+=1){const a=Ue(r,t,i);s[i]?s[i].p(a,f):(s[i]=qe(a),s[i].c(),s[i].m(e.parentNode,e))}for(;i<s.length;i+=1)s[i].d(1);s.length=t.length}},d(r){r&&u(e),nt(s,r)}}}function We(l){let e,t,s;return t=new yt({props:{jigsawConfig:l[3],callbackCompletedExternal:l[9],callbackSavedExternal:l[10],mainMenu:l[11]}}),{c(){e=k("div"),Xe(t.$$.fragment),this.h()},l(r){e=C(r,"DIV",{class:!0});var f=w(e);Ze(t.$$.fragment,f),f.forEach(u),this.h()},h(){o(e,"class","absolute top-0 left-0 w-full h-full flex flex-col items-stretch border-2 border-slate-500")},m(r,f){P(r,e,f),Qe(t,e,null),s=!0},p(r,f){const i={};f&8&&(i.jigsawConfig=r[3]),t.$set(i)},i(r){s||(re(t.$$.fragment,r),s=!0)},o(r){ue(t.$$.fragment,r),s=!1},d(r){r&&u(e),$e(t)}}}function Et(l){let e,t,s,r;const f=[Ct,kt],i=[];function a(n,m){return n[0]!==""?0:1}return t=a(l),s=i[t]=f[t](l),{c(){e=k("div"),s.c(),this.h()},l(n){e=C(n,"DIV",{class:!0});var m=w(e);s.l(m),m.forEach(u),this.h()},h(){o(e,"class","container-bg w-full flex flex-col items-stretch margin-0 min-h-full p-4 svelte-1xrjqdv")},m(n,m){P(n,e,m),i[t].m(e,null),r=!0},p(n,[m]){let x=t;t=a(n),t===x?i[t].p(n,m):(Ke(),ue(i[x],1,1,()=>{i[x]=null}),Ae(),s=i[t],s?s.p(n,m):(s=i[t]=f[t](n),s.c()),re(s,1),s.m(e,null))},i(n){r||(re(s),r=!0)},o(n){ue(s),r=!1},d(n){n&&u(e),i[t].d()}}}const xe="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwbmpsYmpwY2ZlYnFwYXFrcGh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODg1NDM0NTgsImV4cCI6MjAwNDExOTQ1OH0.CsGySz2c8bIWphE6--T51CsmSeBQajfwvBYfTkjviM4",Ee="https://bpnjlbjpcfebqpaqkphy.supabase.co/functions/v1/chaster_utilities";function Fe(l){return l.replace("images2","thumbs2").replace("_o","_t")}function It(l,e,t){let s,r,f,i="Loading extension data...";const a=Ce({jigsaws:[]});ke(l,a,v=>t(5,f=v));const n=Ce(void 0);ke(l,n,v=>t(3,s=v));const m=Ce({});ke(l,m,v=>t(4,r=v));let x=[];a.subscribe(async v=>{const j=v.jigsaws??[];t(1,x=await Promise.all(j.map(async z=>`${await ft(z.imageURL)}-${z.rowColsRatio[0]}x${z.rowColsRatio[1]}`)))});let b="",d="";je(async()=>{d=window.location.hash.substring(1).split("?")[0];const v=window.location.search,j=new URLSearchParams(v);if(d!=="")b=JSON.parse(decodeURIComponent(d)).mainToken;else{const S=j.get("state");S!==null&&(b=JSON.parse(decodeURIComponent(S)).mainToken)}const z=await fetch(Ee,{method:"POST",headers:{Authorization:`Bearer ${xe}`},body:JSON.stringify({action:"jigsaw_puzzles-page",mainToken:b})});if(z.status!==200)throw console.error(`Error retrieving session data: ${await z.text()}`),new Error("error retrieving session data");const U=await z.json();_e(a,f=U.config.config,f);for(const S of f.jigsaws){if(new URL(S.imageURL).host.endsWith("imgbox.com")===!1)throw Error(`unwhitelisted url: ${S.imageURL}`);if(S.imageURL!==void 0&&new URL(S.imageURL).host.endsWith("imgbox.com")===!1)throw Error(`unwhitelisted url: ${S.imageURL}`)}window.localStorage.clear();for(const[S,y]of Object.entries(U.custom))window.localStorage.setItem(S,y);await g(),t(0,i="");let R=0;for(;;){await ut(10);const S=Array.from(document.getElementsByTagName("img"));if(S.length!=f.jigsaws.length)continue;const y=S.filter(B=>B.naturalHeight!==0).length;if(y>R&&(E(),R=y),y===f.jigsaws.length)break}});const _=[];async function g(){for(let v=0;v<f.jigsaws.length;v++){const j=f.jigsaws[v],z=j.rowColsRatio[0]*j.rowColsRatio[1];_[v]===void 0&&(_[v]=new et(j,void 0,""));const[U,R]=await _[v].getSaveData();if(R===void 0)continue;const S=(z-R.connections.length)/(z-1),y=new Date(R.elapsedMS).toISOString().slice(11,19);_e(m,r[U]=[R.connections.length,S,y],r),m.set(r)}}const I=async v=>{await fetch(Ee,{method:"POST",headers:{Authorization:`Bearer ${xe}`},body:JSON.stringify({action:"jigsaw_puzzles-finish",mainToken:b,config:s,save:v})})},h=async(v,j,z,U)=>{g(),z!=="tick"&&j!==void 0&&await fetch(Ee,{method:"POST",headers:{Authorization:`Bearer ${xe}`},body:JSON.stringify({action:"jigsaw_puzzles-update",mainToken:b,encrypted:j,_action:z,key:U})})},p=async v=>{await g(),_e(n,s=void 0,s)};let E;const D=v=>{_e(n,s=v,s)};function G(v){E=v,t(2,E)}return[i,x,E,s,r,f,a,n,m,I,h,p,D,G]}class Rt extends Me{constructor(e){super(),De(this,e,It,Et,Te,{})}}export{Rt as component,Vt as universal};
