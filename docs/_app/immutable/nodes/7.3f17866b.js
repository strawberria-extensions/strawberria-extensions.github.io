import{s as Se,e as m,t as j,a as z,c as _,b as y,d as T,f as h,g as L,p as pe,m as u,X as ve,i as ee,h as i,j as X,Y as xe,F as Ve,k as Oe,o as qe,C as He,z as W,l as Je,n as be}from"../chunks/scheduler.d0887c23.js";import{S as Pe,i as ze,a as Y,g as ue,t as F,c as de,b as Le,d as Me,m as je,e as Te}from"../chunks/index.6bbf7aa7.js";import{e as fe}from"../chunks/each.e59479a4.js";import{w as Ne}from"../chunks/index.973ad0b2.js";import{c as Ye}from"../chunks/logo.09e82b80.js";import{S as Re}from"../chunks/SvelteMarkdown.321f42e1.js";import{b as Ue,d as Be}from"../chunks/utility.4648be72.js";const Fe=!0,ot=Object.freeze(Object.defineProperty({__proto__:null,prerender:Fe},Symbol.toStringTag,{value:"Module"}));function De(r,e,t){const l=r.slice();l[9]=e[t];const a=Be(l[9]);return l[10]=a,l}function Ie(r){let e,t,l=fe(r[2].penaltyConfig.effects),a=[];for(let s=0;s<l.length;s+=1)a[s]=ke(De(r,l,s));const o=s=>F(a[s],1,1,()=>{a[s]=null});return{c(){e=m("ul");for(let s=0;s<a.length;s+=1)a[s].c();this.h()},l(s){e=_(s,"UL",{class:!0});var f=y(e);for(let n=0;n<a.length;n+=1)a[n].l(f);f.forEach(h),this.h()},h(){u(e,"class","flex flex-col list effect-list caption pl-[0.25em] mt-[0.125em] svelte-1fe1t23")},m(s,f){ee(s,e,f);for(let n=0;n<a.length;n+=1)a[n]&&a[n].m(e,null);t=!0},p(s,f){if(f&4){l=fe(s[2].penaltyConfig.effects);let n;for(n=0;n<l.length;n+=1){const d=De(s,l,n);a[n]?(a[n].p(d,f),Y(a[n],1)):(a[n]=ke(d),a[n].c(),Y(a[n],1),a[n].m(e,null))}for(ue(),n=l.length;n<a.length;n+=1)o(n);de()}},i(s){if(!t){for(let f=0;f<l.length;f+=1)Y(a[f]);t=!0}},o(s){a=a.filter(Boolean);for(let f=0;f<a.length;f+=1)F(a[f]);t=!1},d(s){s&&h(e),Ve(a,s)}}}function ke(r){let e,t,l;return t=new Re({props:{source:r[10],isInline:!0}}),{c(){e=m("li"),Le(t.$$.fragment)},l(a){e=_(a,"LI",{});var o=y(e);Me(t.$$.fragment,o),o.forEach(h)},m(a,o){ee(a,e,o),je(t,e,null),l=!0},p(a,o){const s={};o&4&&(s.source=a[10]),t.$set(s)},i(a){l||(Y(t.$$.fragment,a),l=!0)},o(a){F(t.$$.fragment,a),l=!1},d(a){a&&h(e),Te(t)}}}function Xe(r){let e,t,l,a,o=r[2].extensionData.display+"",s,f,n,d,b,C,g,E,x,O,q,U,M,V,H,A,J,P,S,p,ae="Penalty effects:",v,w,c,N=r[2].penaltyData.current+"",B,K,G=r[2].penaltyConfig.required+"",Z,he,te=r[1].what+"",se,le=r[2].penaltyConfig.required>0?"s":"",ne,re,R,I=r[2].penaltyConfig.effects.length>0&&Ie(r);return{c(){e=m("div"),t=m("div"),l=m("div"),a=m("h5"),s=j(o),f=z(),n=m("div"),d=j(r[6]),b=z(),C=m("div"),g=z(),E=m("a"),x=j("Open"),O=z(),q=m("div"),U=j(r[4]),M=z(),V=m("div"),H=m("div"),J=z(),P=m("div"),S=m("div"),p=m("div"),p.textContent=ae,v=z(),I&&I.c(),w=z(),c=m("div"),B=j(N),K=j(" / "),Z=j(G),he=z(),se=j(te),ne=j(le),this.h()},l(k){e=_(k,"DIV",{class:!0});var D=y(e);t=_(D,"DIV",{class:!0});var $=y(t);l=_($,"DIV",{class:!0});var ie=y(l);a=_(ie,"H5",{class:!0});var me=y(a);s=T(me,o),me.forEach(h),f=L(ie),n=_(ie,"DIV",{class:!0});var _e=y(n);d=T(_e,r[6]),_e.forEach(h),ie.forEach(h),b=L($),C=_($,"DIV",{class:!0}),y(C).forEach(h),g=L($),E=_($,"A",{href:!0,target:!0,class:!0});var ge=y(E);x=T(ge,"Open"),ge.forEach(h),$.forEach(h),O=L(D),q=_(D,"DIV",{});var ye=y(q);U=T(ye,r[4]),ye.forEach(h),M=L(D),V=_(D,"DIV",{class:!0});var we=y(V);H=_(we,"DIV",{role:!0,class:!0,style:!0}),y(H).forEach(h),we.forEach(h),J=L(D),P=_(D,"DIV",{class:!0});var oe=y(P);S=_(oe,"DIV",{class:!0});var ce=y(S);p=_(ce,"DIV",{"data-svelte-h":!0}),pe(p)!=="svelte-bjs3vd"&&(p.textContent=ae),v=L(ce),I&&I.l(ce),ce.forEach(h),w=L(oe),c=_(oe,"DIV",{class:!0});var Q=y(c);B=T(Q,N),K=T(Q," / "),Z=T(Q,G),he=L(Q),se=T(Q,te),ne=T(Q,le),Q.forEach(h),oe.forEach(h),D.forEach(h),this.h()},h(){u(a,"class","mb-[0.25em]"),u(n,"class","caption"),u(l,"class","flex flex-col"),u(C,"class","grow"),u(E,"href",r[5]),u(E,"target","_blank"),u(E,"class","btn btn-outline-primary"),u(t,"class","flex flex-row space-x-[1em] items-center mb-[0.75em]"),u(H,"role","progressbar"),u(H,"class","progress-bar"),u(H,"style",A=`width: ${r[3]}%`),u(V,"class","progress"),u(S,"class","flex flex-col grow"),u(c,"class","shrink-0 caption"),u(P,"class","flex flex-row items-start text-sm whitespace-pre-wrap space-x-[1em]"),u(e,"class",re=ve(`card-content flex flex-col space-y-[0.5em] ${r[0]?"w-[32em]":"w-full"}`)+" svelte-1fe1t23")},m(k,D){ee(k,e,D),i(e,t),i(t,l),i(l,a),i(a,s),i(l,f),i(l,n),i(n,d),i(t,b),i(t,C),i(t,g),i(t,E),i(E,x),i(e,O),i(e,q),i(q,U),i(e,M),i(e,V),i(V,H),i(e,J),i(e,P),i(P,S),i(S,p),i(S,v),I&&I.m(S,null),i(P,w),i(P,c),i(c,B),i(c,K),i(c,Z),i(c,he),i(c,se),i(c,ne),R=!0},p(k,[D]){(!R||D&4)&&o!==(o=k[2].extensionData.display+"")&&X(s,o),(!R||D&16)&&X(U,k[4]),(!R||D&8&&A!==(A=`width: ${k[3]}%`))&&u(H,"style",A),k[2].penaltyConfig.effects.length>0?I?(I.p(k,D),D&4&&Y(I,1)):(I=Ie(k),I.c(),Y(I,1),I.m(S,null)):I&&(ue(),F(I,1,1,()=>{I=null}),de()),(!R||D&4)&&N!==(N=k[2].penaltyData.current+"")&&X(B,N),(!R||D&4)&&G!==(G=k[2].penaltyConfig.required+"")&&X(Z,G),(!R||D&2)&&te!==(te=k[1].what+"")&&X(se,te),(!R||D&4)&&le!==(le=k[2].penaltyConfig.required>0?"s":"")&&X(ne,le),(!R||D&1&&re!==(re=ve(`card-content flex flex-col space-y-[0.5em] ${k[0]?"w-[32em]":"w-full"}`)+" svelte-1fe1t23"))&&u(e,"class",re)},i(k){R||(Y(I),R=!0)},o(k){F(I),R=!1},d(k){k&&h(e),I&&I.d()}}}function Ae(r,e,t){let{shouldHorizontal:l}=e,{lockID:a}=e,{extensionLookup:o}=e,{individualPenaltyData:s}=e;const f=`https://chaster.app/locks/${a}/extensions/${s.extensionData._id}`,n=o.key==="extended_wheel"?`Spin the wheel named '${s.penaltyConfig.display}'`:o.key==="jigsaw_puzzles"?`Complete ${s.penaltyConfig.required} new jigsaw puzzles`:"";let d=s.penaltyData.current/s.penaltyConfig.required*100;d>100&&(d=100);let b="",C=setInterval(()=>{const g=new Date().getTime(),E=s.penaltyData.lastPenaltyMS+s.penaltyConfig.interval-g;t(4,b=E>0?Ue(Math.floor(E/1e3)):s.penaltyData.current>s.penaltyConfig.required?"Completed! Waiting for system...":"Too late! Waiting for system...")},200);return xe(()=>{clearInterval(C)}),r.$$set=g=>{"shouldHorizontal"in g&&t(0,l=g.shouldHorizontal),"lockID"in g&&t(7,a=g.lockID),"extensionLookup"in g&&t(1,o=g.extensionLookup),"individualPenaltyData"in g&&t(2,s=g.individualPenaltyData)},[l,o,s,d,b,f,n,a]}class Ge extends Pe{constructor(e){super(),ze(this,e,Ae,Xe,Se,{shouldHorizontal:0,lockID:7,extensionLookup:1,individualPenaltyData:2})}}function Ce(r,e,t){const l=r.slice();l[11]=e[t];const a=l[6][l[11].extensionData.slug];return l[12]=a,l}function Ze(r){let e,t,l,a='<h4 class="mb-0">[üçì] Strawberria Penalties</h4> <span class="caption">Developer: <a href="https://chaster.app/user/strawberria" target="_blank">@strawberria</a></span>',o,s,f=`Extended penalty handling for all personally-developed extensions! <br/>
                    Now supporting extended lock effects and dynamic penalty interval with minute-level granularity!`,n,d,b,C,g,E,x,O,q,U,M,V,H,A,J,P,S=fe(r[5]),p=[];for(let v=0;v<S.length;v+=1)p[v]=Ee(Ce(r,S,v));const ae=v=>F(p[v],1,1,()=>{p[v]=null});return{c(){e=m("div"),t=m("div"),l=m("div"),l.innerHTML=a,o=z(),s=m("div"),s.innerHTML=f,n=z(),d=m("div"),b=m("i"),C=z(),g=m("h3"),E=j(r[2]),x=j(" / "),O=j(r[3]),q=j(" completed"),U=z(),M=m("div"),V=m("div"),A=z(),J=m("div");for(let v=0;v<p.length;v+=1)p[v].c();this.h()},l(v){e=_(v,"DIV",{class:!0});var w=y(e);t=_(w,"DIV",{class:!0});var c=y(t);l=_(c,"DIV",{class:!0,"data-svelte-h":!0}),pe(l)!=="svelte-1drm992"&&(l.innerHTML=a),o=L(c),s=_(c,"DIV",{class:!0,"data-svelte-h":!0}),pe(s)!=="svelte-18bx7mj"&&(s.innerHTML=f),n=L(c),d=_(c,"DIV",{class:!0});var N=y(d);b=_(N,"I",{class:!0}),y(b).forEach(h),C=L(N),g=_(N,"H3",{});var B=y(g);E=T(B,r[2]),x=T(B," / "),O=T(B,r[3]),q=T(B," completed"),B.forEach(h),N.forEach(h),U=L(c),M=_(c,"DIV",{class:!0});var K=y(M);V=_(K,"DIV",{role:!0,class:!0,style:!0}),y(V).forEach(h),K.forEach(h),c.forEach(h),A=L(w),J=_(w,"DIV",{class:!0});var G=y(J);for(let Z=0;Z<p.length;Z+=1)p[Z].l(G);G.forEach(h),w.forEach(h),this.h()},h(){u(l,"class","flex items-end justify-between mb-2"),W(l,"flex-row",r[8]),W(l,"flex-col",!r[8]),W(l,"space-x-1",r[8]),W(l,"items-end",r[8]),u(s,"class","caption mb-3"),u(b,"class","fal fa-tasks fa-2x"),u(d,"class","flex flex-row space-x-[0.5em]"),u(V,"role","progressbar"),u(V,"class","progress-bar"),u(V,"style",H=`width: ${r[4]}%;`),u(M,"class","progress"),u(t,"class","card-content svelte-17a10ne"),W(t,"card-wrapper-desktop",r[8]),u(J,"class","grid gap-[1.5em]"),W(J,"grid-cols-2",r[8]),W(J,"grid-cols-1",!r[8]),u(e,"class",ve(`flex flex-col space-y-[1.5em] ${r[8]?"w-[65.5em]":"w-full"}`)+" svelte-17a10ne")},m(v,w){ee(v,e,w),i(e,t),i(t,l),i(t,o),i(t,s),i(t,n),i(t,d),i(d,b),i(d,C),i(d,g),i(g,E),i(g,x),i(g,O),i(g,q),i(t,U),i(t,M),i(M,V),i(e,A),i(e,J);for(let c=0;c<p.length;c+=1)p[c]&&p[c].m(J,null);P=!0},p(v,w){if((!P||w&4)&&X(E,v[2]),(!P||w&8)&&X(O,v[3]),(!P||w&16&&H!==(H=`width: ${v[4]}%;`))&&u(V,"style",H),w&354){S=fe(v[5]);let c;for(c=0;c<S.length;c+=1){const N=Ce(v,S,c);p[c]?(p[c].p(N,w),Y(p[c],1)):(p[c]=Ee(N),p[c].c(),Y(p[c],1),p[c].m(J,null))}for(ue(),c=S.length;c<p.length;c+=1)ae(c);de()}},i(v){if(!P){for(let w=0;w<S.length;w+=1)Y(p[w]);P=!0}},o(v){p=p.filter(Boolean);for(let w=0;w<p.length;w+=1)F(p[w]);P=!1},d(v){v&&h(e),Ve(p,v)}}}function Qe(r){let e,t,l,a,o,s;return{c(){e=m("div"),t=m("img"),a=z(),o=m("div"),s=j(r[0]),this.h()},l(f){e=_(f,"DIV",{class:!0});var n=y(e);t=_(n,"IMG",{src:!0,alt:!0}),a=L(n),o=_(n,"DIV",{class:!0});var d=y(o);s=T(d,r[0]),d.forEach(h),n.forEach(h),this.h()},h(){Je(t.src,l=Ye)||u(t,"src",l),u(t,"alt","Chaster logo"),u(o,"class","mt-4 caption text-lg"),u(e,"class","w-full h-screen flex flex-col items-center justify-center")},m(f,n){ee(f,e,n),i(e,t),i(e,a),i(e,o),i(o,s)},p(f,n){n&1&&X(s,f[0])},i:be,o:be,d(f){f&&h(e)}}}function Ee(r){let e,t;return e=new Ge({props:{shouldHorizontal:r[8],lockID:r[1],extensionLookup:r[12],individualPenaltyData:r[11]}}),{c(){Le(e.$$.fragment)},l(l){Me(e.$$.fragment,l)},m(l,a){je(e,l,a),t=!0},p(l,a){const o={};a&2&&(o.lockID=l[1]),a&32&&(o.extensionLookup=l[12]),a&32&&(o.individualPenaltyData=l[11]),e.$set(o)},i(l){t||(Y(e.$$.fragment,l),t=!0)},o(l){F(e.$$.fragment,l),t=!1},d(l){Te(e,l)}}}function We(r){let e,t,l,a;const o=[Qe,Ze],s=[];function f(n,d){return n[0]!==""?0:1}return t=f(r),l=s[t]=o[t](r),{c(){e=m("div"),l.c(),this.h()},l(n){e=_(n,"DIV",{class:!0});var d=y(e);l.l(d),d.forEach(h),this.h()},h(){u(e,"class","container-bg min-w-0 min-h-0 p-4 space-y-2 grow svelte-17a10ne")},m(n,d){ee(n,e,d),s[t].m(e,null),a=!0},p(n,[d]){let b=t;t=f(n),t===b?s[t].p(n,d):(ue(),F(s[b],1,1,()=>{s[b]=null}),de(),l=s[t],l?l.p(n,d):(l=s[t]=o[t](n),l.c()),Y(l,1),l.m(e,null))},i(n){a||(Y(l),a=!0)},o(n){F(l),a=!1},d(n){n&&h(e),s[t].d()}}}const Ke="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwbmpsYmpwY2ZlYnFwYXFrcGh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODg1NDM0NTgsImV4cCI6MjAwNDExOTQ1OH0.CsGySz2c8bIWphE6--T51CsmSeBQajfwvBYfTkjviM4",$e="https://bpnjlbjpcfebqpaqkphy.supabase.co/functions/v1/chaster_utilities";function et(r,e,t){let l;const a={"extended-wheel-of-fortune":{key:"extended_wheel",what:"spin"},"jigsaw-puzzles":{key:"jigsaw_puzzles",what:"jigsaw"}};let o="Loading extension data...",s="",f=Ne([]);Oe(r,f,x=>t(5,l=x));let n="",d="";qe(async()=>{d=window.location.hash.substring(1).split("?")[0];const x=window.location.search,O=new URLSearchParams(x);if(d!=="")s=JSON.parse(decodeURIComponent(d)).mainToken;else{const M=O.get("state");M!==null&&(s=JSON.parse(decodeURIComponent(M)).mainToken)}const q=await fetch($e,{method:"POST",headers:{Authorization:`Bearer ${Ke}`},body:JSON.stringify({action:"strawberria_penalties-page",mainToken:s})});if(q.status!==200)throw console.error(`Error retrieving session data: ${await q.text()}`),new Error("error retrieving session data");const U=await q.json();He(f,l=U.data,l),t(1,n=U.lockID),t(0,o="")});let b=0,C=1,g=0;f.subscribe(x=>{t(2,b=0),t(3,C=0);for(const O of x)t(2,b+=O.penaltyData.current>=O.penaltyConfig.required?1:0),t(3,C++,C);t(4,g=C===0?0:b/C*100)});let E=!/Mobi/i.test(window.navigator.userAgent);return[o,n,b,C,g,l,a,f,E]}class ct extends Pe{constructor(e){super(),ze(this,e,et,We,Se,{})}}export{ct as component,ot as universal};
