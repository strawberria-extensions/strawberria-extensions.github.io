import{s as z,f as h,g as _,h as b,d,j as g,i as w,y as D,z as R,o as V,D as P,a as J,F as E,c as C,G as N,x as v,M as x,C as k,I as A,l as L,m as U,J as Y,n as G}from"../chunks/scheduler.6e8049bc.js";import{S as X,i as q}from"../chunks/index.0fccc1b3.js";import{w as B}from"../chunks/index.7f8c83a0.js";import{c as F}from"../chunks/logo.0860a6a8.js";const Z=!0,se=Object.freeze(Object.defineProperty({__proto__:null,prerender:Z},Symbol.toStringTag,{value:"Module"}));function H(c){let t,a,p="Updated JSON Configuration",s,e,n,o,l,f,m,T="Handlebar Text",S,u,O,I;return{c(){t=h("div"),a=h("div"),a.textContent=p,s=J(),e=h("textarea"),n=J(),o=h("hr"),l=J(),f=h("div"),m=h("div"),m.textContent=T,S=J(),u=h("textarea"),this.h()},l(i){t=_(i,"DIV",{class:!0});var r=b(t);a=_(r,"DIV",{"data-svelte-h":!0}),E(a)!=="svelte-mvtttl"&&(a.textContent=p),s=C(r),e=_(r,"TEXTAREA",{class:!0,rows:!0}),b(e).forEach(d),r.forEach(d),n=C(i),o=_(i,"HR",{}),l=C(i),f=_(i,"DIV",{class:!0});var y=b(f);m=_(y,"DIV",{"data-svelte-h":!0}),E(m)!=="svelte-vvi46a"&&(m.textContent=T),S=C(y),u=_(y,"TEXTAREA",{class:!0,rows:!0}),b(u).forEach(d),y.forEach(d),this.h()},h(){g(e,"class","form-control resize-none svelte-1pi0ai7"),g(e,"rows","12"),N(e,"text-invalid",c[3]),g(t,"class","space-y-[0.5em]"),g(u,"class","form-control resize-none"),g(u,"rows","4"),g(f,"class","space-y-[0.5em]")},m(i,r){w(i,t,r),v(t,a),v(t,s),v(t,e),x(e,c[0]),w(i,n,r),w(i,o,r),w(i,l,r),w(i,f,r),v(f,m),v(f,S),v(f,u),x(u,c[1]),O||(I=[k(e,"input",c[5]),k(u,"input",c[6])],O=!0)},p(i,r){r&1&&x(e,i[0]),r&8&&N(e,"text-invalid",i[3]),r&2&&x(u,i[1])},d(i){i&&(d(t),d(n),d(o),d(l),d(f)),O=!1,A(I)}}}function Q(c){let t,a,p,s,e,n;return{c(){t=h("div"),a=h("img"),s=J(),e=h("div"),n=L(c[2]),this.h()},l(o){t=_(o,"DIV",{class:!0});var l=b(t);a=_(l,"IMG",{src:!0,alt:!0}),s=C(l),e=_(l,"DIV",{class:!0});var f=b(e);n=U(f,c[2]),f.forEach(d),l.forEach(d),this.h()},h(){Y(a.src,p=F)||g(a,"src",p),g(a,"alt","Chaster logo"),g(e,"class","mt-4 mb-3 caption text-lg"),g(t,"class","w-full h-screen flex flex-col items-center justify-center")},m(o,l){w(o,t,l),v(t,a),v(t,s),v(t,e),v(e,n)},p(o,l){l&4&&G(n,o[2])},d(o){o&&d(t)}}}function K(c){let t;function a(e,n){return e[2]!==""?Q:H}let p=a(c),s=p(c);return{c(){t=h("div"),s.c(),this.h()},l(e){t=_(e,"DIV",{class:!0});var n=b(t);s.l(n),n.forEach(d),this.h()},h(){g(t,"class","container-bg w-full h-screen pl-3 pr-3 svelte-1pi0ai7")},m(e,n){w(e,t,n),s.m(t,null)},p(e,[n]){p===(p=a(e))&&s?s.p(e,n):(s.d(1),s=p(e),s&&(s.c(),s.m(t,null)))},i:D,o:D,d(e){e&&d(t),s.d()}}}const M="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwbmpsYmpwY2ZlYnFwYXFrcGh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODg1NDM0NTgsImV4cCI6MjAwNDExOTQ1OH0.CsGySz2c8bIWphE6--T51CsmSeBQajfwvBYfTkjviM4",j="https://bpnjlbjpcfebqpaqkphy.supabase.co/functions/v1/chaster_utilities";function W(c,t,a){let p,s=B({});R(c,s,u=>a(9,p=u));let e="",n="",o="",l="Loading extension data...",f="";V(async()=>{f=window.location.hash.substring(1).split("?")[0];const u=window.location.search,O=new URLSearchParams(u);if(f!=="")o=JSON.parse(decodeURIComponent(f)).partnerConfigurationToken;else{const r=O.get("state");r!==null&&r!==""&&(o=JSON.parse(decodeURIComponent(r)).partnerConfigurationToken)}window.parent&&window.parent.postMessage(JSON.stringify({type:"partner_configuration",event:"capabilities",payload:{features:{save:!0}}}),"*"),window.addEventListener("message",async r=>{if(typeof r.data!="string")return;const y=JSON.parse(r.data);y.type==="chaster"&&y.event==="partner_configuration_save"&&(window.parent.postMessage(JSON.stringify({type:"partner_configuration",event:"save_loading"}),"*"),await fetch(j,{method:"POST",headers:{Authorization:`Bearer ${M}`},body:JSON.stringify({action:"config-update",config:{...p,handlebar:n},configToken:o})}),window.parent.postMessage(JSON.stringify({type:"partner_configuration",event:"save_success"}),"*"))}),a(2,l="Retrieving extension config...");const I=await fetch(j,{method:"POST",headers:{Authorization:`Bearer ${M}`},body:JSON.stringify({action:"config-get",configToken:o})});if(I.status!==200){console.error(`Error retrieving config data: ${await I.text()}`);return}const i=await I.json();a(1,n=i.handlebar??""),delete i.handlebar,s.set(i),a(0,e=JSON.stringify(i)),a(2,l="")});let m=!1;function T(){e=this.value,a(0,e)}function S(){n=this.value,a(1,n)}return c.$$.update=()=>{if(c.$$.dirty&1){a(3,m=!0);try{P(s,p=JSON.parse(e),p),a(3,m=!1)}catch{}}},[e,n,l,m,s,T,S]}class ne extends X{constructor(t){super(),q(this,t,W,K,z,{})}}export{ne as component,se as universal};
