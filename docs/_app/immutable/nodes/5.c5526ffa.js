import{s as x,e as v,c as g,b,f as h,m as _,i as k,n as q,k as O,o as ee,C as R,a as V,g as T,h as y,F as te,t as S,d as E,l as le,j as M,p as se,z as A,q as ie}from"../chunks/scheduler.d0887c23.js";import{e as G}from"../chunks/each.e59479a4.js";import{S as re,i as ne}from"../chunks/index.6bbf7aa7.js";import{w as J}from"../chunks/index.973ad0b2.js";import{c as ae}from"../chunks/logo.09e82b80.js";const oe=!0,De=Object.freeze(Object.defineProperty({__proto__:null,prerender:oe},Symbol.toStringTag,{value:"Module"})),ce=""+new URL("../assets/playing_card.49f7bc47.png",import.meta.url).href;function X(s,e,l){const a=s.slice();return a[21]=e[l],a[23]=l,a}function N(s){const e=s.slice(),l=e[7][e[3][0]];return e[24]=l,e}function ue(s){let e,l,a,r,t;function n(u,m){return u[6].settings.detail==="hidden"?he:de}let f=n(s),c=f(s),o=G({length:s[5]??32}),i=[];for(let u=0;u<o.length;u+=1)i[u]=Q(X(s,o,u));return{c(){e=v("div"),c.c(),l=V(),a=v("div"),r=v("div"),t=v("div");for(let u=0;u<i.length;u+=1)i[u].c();this.h()},l(u){e=g(u,"DIV",{class:!0});var m=b(e);c.l(m),m.forEach(h),l=T(u),a=g(u,"DIV",{class:!0});var d=b(a);r=g(d,"DIV",{class:!0});var I=b(r);t=g(I,"DIV",{class:!0});var w=b(t);for(let C=0;C<i.length;C+=1)i[C].l(w);w.forEach(h),I.forEach(h),d.forEach(h),this.h()},h(){_(e,"class","text-xl"),_(t,"class","h-full w-full flex flex-col flex-wrap items-center justify-center overflow-x-auto"),_(r,"class","absolute inset-0 flex items-center justify-center"),_(a,"class","w-full h-full relative")},m(u,m){k(u,e,m),c.m(e,null),k(u,l,m),k(u,a,m),y(a,r),y(r,t);for(let d=0;d<i.length;d+=1)i[d]&&i[d].m(t,null)},p(u,m){if(f===(f=n(u))&&c?c.p(u,m):(c.d(1),c=f(u),c&&(c.c(),c.m(e,null))),m&4270){o=G({length:u[5]??32});let d;for(d=0;d<o.length;d+=1){const I=X(u,o,d);i[d]?i[d].p(I,m):(i[d]=Q(I),i[d].c(),i[d].m(t,null))}for(;d<i.length;d+=1)i[d].d(1);i.length=o.length}},d(u){u&&(h(e),h(l),h(a)),c.d(),te(i,u)}}}function fe(s){let e,l,a,r,t,n;return{c(){e=v("div"),l=v("img"),r=V(),t=v("div"),n=S(s[0]),this.h()},l(f){e=g(f,"DIV",{class:!0});var c=b(e);l=g(c,"IMG",{src:!0,alt:!0}),r=T(c),t=g(c,"DIV",{class:!0});var o=b(t);n=E(o,s[0]),o.forEach(h),c.forEach(h),this.h()},h(){le(l.src,a=ae)||_(l,"src",a),_(l,"alt","Chaster logo"),_(t,"class","mt-4 caption text-lg"),_(e,"class","w-full h-screen flex flex-col items-center justify-center")},m(f,c){k(f,e,c),y(e,l),y(e,r),y(e,t),y(t,n)},p(f,c){c&1&&M(n,f[0])},d(f){f&&h(e)}}}function de(s){let e=s[4].remaining.reduce($,0)+"",l,a;return{c(){l=S(e),a=S(" Cards Remaining")},l(r){l=E(r,e),a=E(r," Cards Remaining")},m(r,t){k(r,l,t),k(r,a,t)},p(r,t){t&16&&e!==(e=r[4].remaining.reduce($,0)+"")&&M(l,e)},d(r){r&&(h(l),h(a))}}}function he(s){let e;return{c(){e=S("??? Cards Remaining")},l(l){e=E(l,"??? Cards Remaining")},m(l,a){k(l,e,a)},p:q,d(l){l&&h(e)}}}function Z(s){let e,l;function a(n,f){return n[3][0]==="custom"&&n[3][1]!==void 0?me:_e}let r=a(s),t=r(s);return{c(){e=v("div"),t.c(),this.h()},l(n){e=g(n,"DIV",{class:!0,style:!0});var f=b(e);t.l(f),f.forEach(h),this.h()},h(){var n;_(e,"class","w-full h-full flex flex-col items-center justify-center rounded-[0.3em]"),_(e,"style",l=`background-color: ${s[3][0]!=="custom"?s[24][1]:(n=s[3][1])==null?void 0:n.color}`)},m(n,f){k(n,e,f),t.m(e,null)},p(n,f){var c;r===(r=a(n))&&t?t.p(n,f):(t.d(1),t=r(n),t&&(t.c(),t.m(e,null))),f&8&&l!==(l=`background-color: ${n[3][0]!=="custom"?n[24][1]:(c=n[3][1])==null?void 0:c.color}`)&&_(e,"style",l)},d(n){n&&h(e),t.d()}}}function _e(s){let e,l=s[24][0]+"",a,r,t,n=s[24][2]+"",f,c;return{c(){e=v("div"),a=S(l),r=V(),t=v("div"),f=S(n),this.h()},l(o){e=g(o,"DIV",{class:!0});var i=b(e);a=E(i,l),i.forEach(h),r=T(o),t=g(o,"DIV",{class:!0,style:!0});var u=b(t);f=E(u,n),u.forEach(h),this.h()},h(){_(e,"class","text-2xl"),_(t,"class","text-xl font-semibold"),_(t,"style",c=`color: ${H(s[24][1])?"white":"black"}`)},m(o,i){k(o,e,i),y(e,a),k(o,r,i),k(o,t,i),y(t,f)},p(o,i){i&8&&l!==(l=o[24][0]+"")&&M(a,l),i&8&&n!==(n=o[24][2]+"")&&M(f,n),i&8&&c!==(c=`color: ${H(o[24][1])?"white":"black"}`)&&_(t,"style",c)},d(o){o&&(h(e),h(r),h(t))}}}function me(s){let e,l=s[3][1].emoji+"",a,r,t,n=s[3][1].name+"",f,c;return{c(){e=v("div"),a=S(l),r=V(),t=v("div"),f=S(n),this.h()},l(o){e=g(o,"DIV",{class:!0});var i=b(e);a=E(i,l),i.forEach(h),r=T(o),t=g(o,"DIV",{class:!0,style:!0});var u=b(t);f=E(u,n),u.forEach(h),this.h()},h(){_(e,"class","text-2xl"),_(t,"class","text-xl font-semibold"),_(t,"style",c=`color: ${H(s[3][1].color)?"white":"black"}`)},m(o,i){k(o,e,i),y(e,a),k(o,r,i),k(o,t,i),y(t,f)},p(o,i){i&8&&l!==(l=o[3][1].emoji+"")&&M(a,l),i&8&&n!==(n=o[3][1].name+"")&&M(f,n),i&8&&c!==(c=`color: ${H(o[3][1].color)?"white":"black"}`)&&_(t,"style",c)},d(o){o&&(h(e),h(r),h(t))}}}function Q(s){let e,l,a,r="",t,n,f,c,o,i=s[2]===s[23]&&s[3]!==void 0&&Z(N(s));function u(){return s[13](s[23])}return{c(){e=v("div"),l=v("div"),a=v("div"),a.innerHTML=r,t=V(),n=v("div"),i&&i.c(),f=V(),this.h()},l(m){e=g(m,"DIV",{class:!0});var d=b(e);l=g(d,"DIV",{class:!0});var I=b(l);a=g(I,"DIV",{class:!0,style:!0,"data-svelte-h":!0}),se(a)!=="svelte-1dqx6jq"&&(a.innerHTML=r),t=T(I),n=g(I,"DIV",{class:!0});var w=b(n);i&&i.l(w),w.forEach(h),I.forEach(h),f=T(d),d.forEach(h),this.h()},h(){_(a,"class","flip-card-front flex flex-col items-center justify-center svelte-1vristt"),_(a,"style",`background-image: url(${ce})`),_(n,"class","flip-card-back svelte-1vristt"),_(l,"class","flip-card-inner svelte-1vristt"),_(e,"class","w-[7.5em] h-[10.5em] m-[1em] flip-card svelte-1vristt"),A(e,"flip-card-flipped",s[23]===s[1]&&s[23]===s[2])},m(m,d){k(m,e,d),y(e,l),y(l,a),y(l,t),y(l,n),i&&i.m(n,null),y(e,f),c||(o=ie(e,"click",u),c=!0)},p(m,d){s=m,s[2]===s[23]&&s[3]!==void 0?i?i.p(N(s),d):(i=Z(N(s)),i.c(),i.m(n,null)):i&&(i.d(1),i=null),d&6&&A(e,"flip-card-flipped",s[23]===s[1]&&s[23]===s[2])},d(m){m&&h(e),i&&i.d(),c=!1,o()}}}function pe(s){let e;function l(t,n){return t[0]!==""?fe:ue}let a=l(s),r=a(s);return{c(){e=v("div"),r.c(),this.h()},l(t){e=g(t,"DIV",{class:!0});var n=b(e);r.l(n),n.forEach(h),this.h()},h(){_(e,"class","container-bg w-full flex flex-col items-stretch margin-0 min-h-full p-4 svelte-1vristt")},m(t,n){k(t,e,n),r.m(e,null)},p(t,[n]){a===(a=l(t))&&r?r.p(t,n):(r.d(1),r=a(t),r&&(r.c(),r.m(e,null)))},i:q,o:q,d(t){t&&h(e),r.d()}}}const K="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwbmpsYmpwY2ZlYnFwYXFrcGh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODg1NDM0NTgsImV4cCI6MjAwNDExOTQ1OH0.CsGySz2c8bIWphE6--T51CsmSeBQajfwvBYfTkjviM4",W="https://bpnjlbjpcfebqpaqkphy.supabase.co/functions/v1/chaster_utilities";function H(s){let e=s.charAt(0)==="#"?s.substring(1,7):s,l=parseInt(e.substring(0,2),16),a=parseInt(e.substring(2,4),16),r=parseInt(e.substring(4,6),16);return l*.299+a*.587+r*.114<=186}const $=(s,e)=>s+=e.count;function ve(s,e,l){let a,r,t,n;const f={key:["🔑","#10b981","Key"],red:["⌛","#ef4444","Miss"],sticky:["⌛","#f97316","Sticky"],yellow:["🎲","#fde047","Random"],reset:["🔄","#0ea5e9","Reset"],freeze:["❄️","#22d3ee","Freeze"],multiply:["✖️","#a855f7","Multiply"]};let c="Loading extension data...",o="";const i=J();O(s,i,p=>l(6,n=p));const u=J();O(s,u,p=>l(4,r=p));const m=J();O(s,m,p=>l(5,t=p));const d=J(void 0);O(s,d,p=>l(3,a=p));let I="";ee(async()=>{I=window.location.hash.substring(1).split("?")[0];const p=window.location.search,j=new URLSearchParams(p);if(I!=="")o=JSON.parse(decodeURIComponent(I)).mainToken;else{const L=j.get("state");L!==null&&(o=JSON.parse(decodeURIComponent(L)).mainToken)}l(0,c="Retrieving key hunt data...");const D=await fetch(W,{method:"POST",headers:{Authorization:`Bearer ${K}`},body:JSON.stringify({action:"key_hunt-page",mainToken:o})});if(D.status!==200)throw console.error(`Error retrieving session data: ${await D.text()}`),new Error("error retrieving session data");const F=await D.json();F.userRole,R(i,n=F.config,n),R(u,r=F.customData,r),R(m,t=F.count,t),l(0,c="")});let w=!1,C,P,B;function U(p,j=!1){w!==!0&&(w=!0,setTimeout(()=>{w=!1},800),C===p?(l(1,C=void 0),setTimeout(()=>{l(2,P=void 0),j&&R(m,t=B,t)},800)):(l(2,P=p),l(1,C=p)))}let z=!1;async function Y(p){if(z===!0)return;if(C===p){U(p,!0);return}z=!0;const j=await fetch(W,{method:"POST",headers:{Authorization:`Bearer ${K}`},body:JSON.stringify({action:"key_hunt-pick",mainToken:o,index:p})});if(j.status>200){alert(`Error picking card, please contact @strawberria: ${await j.text()}`);return}const D=await j.json();R(u,r=D.customData,r),B=D.count,R(d,a=[D.chosenCardType,D.chosenCardCustom],a),z=!1,U(p)}return[c,C,P,a,r,t,n,f,i,u,m,d,Y,p=>{Y(p)}]}class Se extends re{constructor(e){super(),ne(this,e,ve,pe,x,{})}}export{Se as component,De as universal};
