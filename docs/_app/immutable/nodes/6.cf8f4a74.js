import{s as F,e as _,c as b,b as j,f,p as v,i as S,n as V,k as A,o as H,A as R,a as x,w as q,g as k,x as N,h as w,B as T,y as P,z as Z,t as K,d as Q,C as W,j as $}from"../chunks/scheduler.9f6e3c65.js";import{S as ee,i as te}from"../chunks/index.0f662661.js";import{w as L}from"../chunks/index.8620d8bc.js";import{V as se,s as ae,a as ie,b as re}from"../chunks/sub-penaltyData.82efb90a.js";import{b as ne}from"../chunks/_commonjsHelpers.573e169a.js";const oe={config:{$schema:"https://json-schema.org/draft/2020-12/schema",type:"object",properties:{wheels:{type:"object",additionalProperties:{type:"object",properties:{display:{type:"string"},note:{type:"string"},settings:{type:"object",properties:{disabled:{type:"boolean"},hiddenEffects:{type:"boolean"},hiddenOutcomes:{type:"boolean"},hiddenPercentages:{type:"boolean"}},required:["disabled","hiddenEffects","hiddenOutcomes","hiddenPercentages"]},regularity:{type:"object",properties:{interval:{type:"integer",minimum:6e4},mode:{type:"string",enum:["cumulative","non_cumulative","unlimited"]}},required:["interval","mode"]},outcomes:{type:"array",items:{type:"object",properties:{percentage:{type:"string",pattern:"^\\d+(\\.\\d+)?$"},text:{type:"string"},effects:{$ref:"/lockEffects"}},required:["percentage","text","effects"]}}},required:["display","settings","regularity","outcomes"]}}},required:["wheels"]},custom:{type:"object",properties:{wheels:{type:"object",additionalProperties:{type:"object",properties:{lastActionTimeMS:{type:"integer",exclusiveMinimum:0}},required:["lastActionTimeMS"]}}},required:["wheels"]}},le={config:{$schema:"https://json-schema.org/draft/2020-12/schema",type:"object",properties:{extended_wheel:{type:"object",additionalProperties:{$ref:"/penaltyData"}}},required:[]},custom:{}},ce={config:{},custom:{}},pe={config:{$schema:"https://json-schema.org/draft/2020-12/schema",type:"object",properties:{tasks:{type:"object",additionalProperties:{type:"object",properties:{display:{type:"string"},note:{type:"string"},feedback:{type:"string"},settings:{type:"object",properties:{times:{type:"number",exclusiveMinimum:0},extra:{type:"number",minimum:0},delayMS:{type:"number",minimum:0},delayExtra:{type:"number",exclusiveMinimum:0},hidden:{type:"boolean"},chinese:{type:"boolean"}},required:["times","extra","delayMS","delayExtra","hidden","chinese"]},phrases:{type:"array",items:{type:"string"}}},required:["display","settings","phrases"]}}},required:["tasks"]},custom:{}},U={extended_wheel:oe,strawberria_penalties:le,jigsaw_puzzles:ce,typing_tasks:pe},ue=!0,de=({params:r})=>({slug:r.slug});function fe(){return[{slug:"extended_wheel"},{slug:"strawberria_penalties"},{slug:"jigsaw_puzzles"}]}const je=Object.freeze(Object.defineProperty({__proto__:null,entries:fe,load:de,prerender:ue},Symbol.toStringTag,{value:"Module"}));function me(r){let t,s,d="Updated JSON Configuration",a,e,n,u,l,h,i,c,C="Handlebar Text",I,y,E,D,g=r[0].slug!=="strawberria_penalties"&&X(r);return{c(){t=_("div"),s=_("div"),s.textContent=d,a=x(),e=_("textarea"),n=x(),u=_("hr"),l=x(),g&&g.c(),h=x(),i=_("div"),c=_("div"),c.textContent=C,I=x(),y=_("textarea"),this.h()},l(o){t=b(o,"DIV",{class:!0});var m=j(t);s=b(m,"DIV",{"data-svelte-h":!0}),q(s)!=="svelte-mvtttl"&&(s.textContent=d),a=k(m),e=b(m,"TEXTAREA",{class:!0,rows:!0}),j(e).forEach(f),m.forEach(f),n=k(o),u=b(o,"HR",{}),l=k(o),g&&g.l(o),h=k(o),i=b(o,"DIV",{class:!0});var p=j(i);c=b(p,"DIV",{"data-svelte-h":!0}),q(c)!=="svelte-vvi46a"&&(c.textContent=C),I=k(p),y=b(p,"TEXTAREA",{class:!0,rows:!0}),j(y).forEach(f),p.forEach(f),this.h()},h(){v(e,"class","form-control resize-none svelte-1jksn6l"),v(e,"rows","6"),N(e,"text-invalid",r[5]),v(t,"class","space-y-[0.5em]"),v(y,"class","form-control resize-none"),v(y,"rows","2"),v(i,"class","space-y-[0.5em]")},m(o,m){S(o,t,m),w(t,s),w(t,a),w(t,e),T(e,r[1]),S(o,n,m),S(o,u,m),S(o,l,m),g&&g.m(o,m),S(o,h,m),S(o,i,m),w(i,c),w(i,I),w(i,y),T(y,r[3]),E||(D=[P(e,"input",r[11]),P(y,"input",r[13])],E=!0)},p(o,m){m&2&&T(e,o[1]),m&32&&N(e,"text-invalid",o[5]),o[0].slug!=="strawberria_penalties"?g?g.p(o,m):(g=X(o),g.c(),g.m(h.parentNode,h)):g&&(g.d(1),g=null),m&8&&T(y,o[3])},d(o){o&&(f(t),f(n),f(u),f(l),f(h),f(i)),g&&g.d(o),E=!1,Z(D)}}}function he(r){let t,s,d,a,e,n;return{c(){t=_("div"),s=_("img"),a=x(),e=_("div"),n=K(r[4]),this.h()},l(u){t=b(u,"DIV",{class:!0});var l=j(t);s=b(l,"IMG",{src:!0,alt:!0}),a=k(l),e=b(l,"DIV",{class:!0});var h=j(e);n=Q(h,r[4]),h.forEach(f),l.forEach(f),this.h()},h(){W(s.src,d=ne)||v(s,"src",d),v(s,"alt","Chaster logo"),v(e,"class","mt-4 mb-3 caption text-lg"),v(t,"class","w-full h-screen flex flex-col items-center justify-center")},m(u,l){S(u,t,l),w(t,s),w(t,a),w(t,e),w(e,n)},p(u,l){l&16&&$(n,u[4])},d(u){u&&f(t)}}}function X(r){let t,s,d="Database Custom Data",a,e,n,u,l,h;return{c(){t=_("div"),s=_("div"),s.textContent=d,a=x(),e=_("textarea"),n=x(),u=_("hr"),this.h()},l(i){t=b(i,"DIV",{class:!0});var c=j(t);s=b(c,"DIV",{"data-svelte-h":!0}),q(s)!=="svelte-kap2pk"&&(s.textContent=d),a=k(c),e=b(c,"TEXTAREA",{class:!0,rows:!0}),j(e).forEach(f),c.forEach(f),n=k(i),u=b(i,"HR",{}),this.h()},h(){v(e,"class","form-control resize-none svelte-1jksn6l"),v(e,"rows","2"),N(e,"text-invalid",r[6]),v(t,"class","space-y-[0.5em]")},m(i,c){S(i,t,c),w(t,s),w(t,a),w(t,e),T(e,r[2]),S(i,n,c),S(i,u,c),l||(h=P(e,"input",r[12]),l=!0)},p(i,c){c&4&&T(e,i[2]),c&64&&N(e,"text-invalid",i[6])},d(i){i&&(f(t),f(n),f(u)),l=!1,h()}}}function ge(r){let t;function s(e,n){return e[4]!==""?he:me}let d=s(r),a=d(r);return{c(){t=_("div"),a.c(),this.h()},l(e){t=b(e,"DIV",{class:!0});var n=j(t);a.l(n),n.forEach(f),this.h()},h(){v(t,"class","container-bg w-full h-screen pl-3 pr-3 mt-2 svelte-1jksn6l")},m(e,n){S(e,t,n),a.m(t,null)},p(e,[n]){d===(d=s(e))&&a?a.p(e,n):(a.d(1),a=d(e),a&&(a.c(),a.m(t,null)))},i:V,o:V,d(e){e&&f(t),a.d()}}}const Y="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwbmpsYmpwY2ZlYnFwYXFrcGh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODg1NDM0NTgsImV4cCI6MjAwNDExOTQ1OH0.CsGySz2c8bIWphE6--T51CsmSeBQajfwvBYfTkjviM4",B="https://bpnjlbjpcfebqpaqkphy.supabase.co/functions/v1/chaster_utilities";function ye(r,t,s){let d,a,{data:e}=t,n=L({});A(r,n,p=>s(10,a=p));let u=L({});A(r,u,p=>s(9,d=p));let l="",h="",i="",c="",C="Loading extension data...",I="";H(async()=>{I=window.location.hash.substring(1).split("?")[0];const p=window.location.search,G=new URLSearchParams(p);if(I!=="")c=JSON.parse(decodeURIComponent(I)).partnerConfigurationToken;else{const O=G.get("state");O!==null&&O!==""&&(c=JSON.parse(decodeURIComponent(O)).partnerConfigurationToken)}window.parent&&window.parent.postMessage(JSON.stringify({type:"partner_configuration",event:"capabilities",payload:{features:{save:!0}}}),"*"),window.addEventListener("message",async O=>{if(typeof O.data!="string")return;const z=JSON.parse(O.data);z.type==="chaster"&&z.event==="partner_configuration_save"&&(window.parent.postMessage(JSON.stringify({type:"partner_configuration",event:"save_loading"}),"*"),await fetch(B,{method:"POST",headers:{Authorization:`Bearer ${Y}`},body:JSON.stringify({action:"config-update",config:{...a,handlebar:i},configToken:c,customKey:e.slug,customData:d})}),window.parent.postMessage(JSON.stringify({type:"partner_configuration",event:"save_success"}),"*"))}),s(4,C="Retrieving extension config...");const M=await fetch(B,{method:"POST",headers:{Authorization:`Bearer ${Y}`},body:JSON.stringify({action:"config-get",configToken:c,customKey:e.slug})});if(M.status!==200){console.error(`Error retrieving config data: ${await M.text()}`);return}const J=await M.json();s(3,i=J.config.handlebar??""),delete J.config.handlebar,n.set(J.config),s(1,l=JSON.stringify(a)),u.set(J.custom),s(2,h=JSON.stringify(d)),s(4,C="")});const y=new se;y.addSchema(ae,"/lockEffect"),y.addSchema(ie,"/lockEffects"),y.addSchema(re,"/penaltyData");let E=!1,D=!1;function g(){l=this.value,s(1,l)}function o(){h=this.value,s(2,h)}function m(){i=this.value,s(3,i)}return r.$$set=p=>{"data"in p&&s(0,e=p.data)},r.$$.update=()=>{if(r.$$.dirty&1027){s(5,E=!0);try{R(n,a=JSON.parse(l),a);const p=y.validate(a,U[e.slug].config);s(5,E=!p.valid),p.errors.length>0&&console.log(p.errors)}catch{}}if(r.$$.dirty&517){s(6,D=!0);try{R(u,d=JSON.parse(h),d);const p=y.validate(d,U[e.slug].custom);s(6,D=!p.valid),p.errors.length>0&&console.log(p.errors)}catch{}}},[e,l,h,i,C,E,D,n,u,d,a,g,o,m]}class xe extends ee{constructor(t){super(),te(this,t,ye,ge,F,{data:0})}}export{xe as component,je as universal};
