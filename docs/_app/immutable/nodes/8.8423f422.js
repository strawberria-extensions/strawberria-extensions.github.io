import{s as Oe,e as d,c as u,b as _,f as c,m as o,i as F,n as se,o as Ne,a as R,t as ae,p as ee,g as O,d as ne,v as ye,z as q,h as i,q as Se,j as fe,F as ke,B as xe,l as Je}from"../chunks/scheduler.bf7cec6e.js";import{e as te}from"../chunks/each.e59479a4.js";import{S as Le,i as ze}from"../chunks/index.11aa0ef0.js";import{c as Be}from"../chunks/logo.09e82b80.js";import{r as le,g as Ee}from"../chunks/utility.ad7e1a81.js";const Ye=!0,$e=Object.freeze(Object.defineProperty({__proto__:null,prerender:Ye},Symbol.toStringTag,{value:"Module"}));function Ve(r,e,t){const l=r.slice();return l[13]=e[t],l[15]=t,l}function Ce(r,e,t){const l=r.slice();return l[13]=e[t],l[15]=t,l}function qe(r){let e,t,l,a,f=`<div class="flex flex-col"><h4 class="w-full">Roll the dice</h4> <p class="caption">If you score lower than the bot, time will be added. If you do better, time will be removed.
                                <br/>
                                Though, upon first glance these dice seem somewhat... unnatural. Still feeling lucky?</p></div> <span class="caption">Developer: @strawberria</span>`,h,p,v,k,y,A,L,V,H="You",P,b,m,g,j,U,x,he="The bot",re,N,E,M,ve='<span aria-hidden="true">Ã—</span> <span class="sr-only">Close alert</span>',ie,G,X,oe,z,C,ce,Z,de,ue,_e,B=te({length:r[5][0]}),I=[];for(let s=0;s<B.length;s+=1)I[s]=Ae(Ce(r,B,s));let Y=te({length:r[5][1]}),w=[];for(let s=0;s<Y.length;s+=1)w[s]=je(Ve(r,Y,s));let T=r[3]!==""&&Me(r);return{c(){e=d("div"),t=d("div"),l=d("div"),a=d("div"),a.innerHTML=f,h=R(),p=d("div"),v=d("div"),k=d("div"),y=d("div");for(let s=0;s<I.length;s+=1)I[s].c();L=R(),V=d("div"),V.textContent=H,P=R(),b=d("div"),m=d("div"),g=d("div");for(let s=0;s<w.length;s+=1)w[s].c();U=R(),x=d("div"),x.textContent=he,re=R(),N=d("div"),E=d("div"),M=d("button"),M.innerHTML=ve,ie=R(),G=d("span"),X=ae(r[2]),oe=R(),z=d("div"),C=d("button"),ce=ae("Roll the dice"),de=R(),T&&T.c(),this.h()},l(s){e=u(s,"DIV",{class:!0});var D=_(e);t=u(D,"DIV",{class:!0});var n=_(t);l=u(n,"DIV",{class:!0});var S=_(l);a=u(S,"DIV",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-1fmr9yu"&&(a.innerHTML=f),h=O(S),p=u(S,"DIV",{class:!0});var Q=_(p);v=u(Q,"DIV",{class:!0});var K=_(v);k=u(K,"DIV",{class:!0});var pe=_(k);y=u(pe,"DIV",{class:!0,"data-side":!0,style:!0});var me=_(y);for(let J=0;J<I.length;J+=1)I[J].l(me);me.forEach(c),pe.forEach(c),L=O(K),V=u(K,"DIV",{class:!0,"data-svelte-h":!0}),ee(V)!=="svelte-12bdzwm"&&(V.textContent=H),K.forEach(c),P=O(Q),b=u(Q,"DIV",{class:!0});var W=_(b);m=u(W,"DIV",{class:!0});var ge=_(m);g=u(ge,"DIV",{class:!0,"data-side":!0,style:!0});var be=_(g);for(let J=0;J<w.length;J+=1)w[J].l(be);be.forEach(c),ge.forEach(c),U=O(W),x=u(W,"DIV",{class:!0,"data-svelte-h":!0}),ee(x)!=="svelte-1wc6ghh"&&(x.textContent=he),W.forEach(c),Q.forEach(c),re=O(S),N=u(S,"DIV",{class:!0});var Ie=_(N);E=u(Ie,"DIV",{role:!0,class:!0});var $=_(E);M=u($,"BUTTON",{type:!0,class:!0,"data-svelte-h":!0}),ee(M)!=="svelte-oelkob"&&(M.innerHTML=ve),ie=O($),G=u($,"SPAN",{});var we=_(G);X=ne(we,r[2]),we.forEach(c),$.forEach(c),Ie.forEach(c),oe=O(S),z=u(S,"DIV",{class:!0});var De=_(z);C=u(De,"BUTTON",{type:!0,class:!0});var Te=_(C);ce=ne(Te,"Roll the dice"),Te.forEach(c),De.forEach(c),de=O(S),T&&T.l(S),S.forEach(c),n.forEach(c),D.forEach(c),this.h()},h(){o(a,"class","flex flex-row justify-between w-full"),o(y,"class","dice"),o(y,"data-side",A=r[5][0]),ye(y,"background-color","#f7dcda"),o(k,"class","DiceFace"),o(V,"class","mt-2"),o(v,"class","dice-col"),o(g,"class","dice"),o(g,"data-side",j=r[5][1]),ye(g,"background-color","#f7dcda"),o(m,"class","DiceFace"),o(x,"class","mt-2"),o(b,"class","dice-col"),o(p,"class","dices w-full"),o(M,"type","button"),o(M,"class","close"),o(E,"role","alert"),o(E,"class","alert alert-dismissible"),q(E,"alert-success",r[1]<=0),q(E,"alert-danger",r[1]>0),o(N,"class","mt-4 w-full"),q(N,"hidden",r[2]===""),o(C,"type","button"),o(C,"class","mb-2 btn btn-primary"),C.disabled=Z=r[4]||r[3]!=="",o(z,"class","text-center"),o(l,"class","DiceExtension card-content flex flex-col items-center"),o(t,"class","dice-container"),o(e,"class","dice-container-row")},m(s,D){F(s,e,D),i(e,t),i(t,l),i(l,a),i(l,h),i(l,p),i(p,v),i(v,k),i(k,y);for(let n=0;n<I.length;n+=1)I[n]&&I[n].m(y,null);i(v,L),i(v,V),i(p,P),i(p,b),i(b,m),i(m,g);for(let n=0;n<w.length;n+=1)w[n]&&w[n].m(g,null);i(b,U),i(b,x),i(l,re),i(l,N),i(N,E),i(E,M),i(E,ie),i(E,G),i(G,X),i(l,oe),i(l,z),i(z,C),i(C,ce),i(l,de),T&&T.m(l,null),ue||(_e=[Se(M,"click",r[7]),Se(C,"click",r[6])],ue=!0)},p(s,D){if(D&32){B=te({length:s[5][0]});let n;for(n=0;n<B.length;n+=1){const S=Ce(s,B,n);I[n]?I[n].p(S,D):(I[n]=Ae(),I[n].c(),I[n].m(y,null))}for(;n<I.length;n+=1)I[n].d(1);I.length=B.length}if(D&32&&A!==(A=s[5][0])&&o(y,"data-side",A),D&32){Y=te({length:s[5][1]});let n;for(n=0;n<Y.length;n+=1){const S=Ve(s,Y,n);w[n]?w[n].p(S,D):(w[n]=je(),w[n].c(),w[n].m(g,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=Y.length}D&32&&j!==(j=s[5][1])&&o(g,"data-side",j),D&4&&fe(X,s[2]),D&2&&q(E,"alert-success",s[1]<=0),D&2&&q(E,"alert-danger",s[1]>0),D&4&&q(N,"hidden",s[2]===""),D&24&&Z!==(Z=s[4]||s[3]!=="")&&(C.disabled=Z),s[3]!==""?T?T.p(s,D):(T=Me(s),T.c(),T.m(l,null)):T&&(T.d(1),T=null)},d(s){s&&c(e),ke(I,s),ke(w,s),T&&T.d(),ue=!1,xe(_e)}}}function Fe(r){let e,t,l,a,f,h;return{c(){e=d("div"),t=d("img"),a=R(),f=d("div"),h=ae(r[0]),this.h()},l(p){e=u(p,"DIV",{class:!0});var v=_(e);t=u(v,"IMG",{src:!0,alt:!0}),a=O(v),f=u(v,"DIV",{class:!0});var k=_(f);h=ne(k,r[0]),k.forEach(c),v.forEach(c),this.h()},h(){Je(t.src,l=Be)||o(t,"src",l),o(t,"alt","Chaster logo"),o(f,"class","mt-4 caption text-lg"),o(e,"class","w-full h-screen flex flex-col items-center justify-center")},m(p,v){F(p,e,v),i(e,t),i(e,a),i(e,f),i(f,h)},p(p,v){v&1&&fe(h,p[0])},d(p){p&&c(e)}}}function Ae(r){let e;return{c(){e=d("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),_(e).forEach(c),this.h()},h(){o(e,"class","dot")},m(t,l){F(t,e,l)},p:se,d(t){t&&c(e)}}}function je(r){let e;return{c(){e=d("span"),this.h()},l(t){e=u(t,"SPAN",{class:!0}),_(e).forEach(c),this.h()},h(){o(e,"class","dot")},m(t,l){F(t,e,l)},p:se,d(t){t&&c(e)}}}function Me(r){let e,t;return{c(){e=d("div"),t=ae(r[3])},l(l){e=u(l,"DIV",{});var a=_(e);t=ne(a,r[3]),a.forEach(c)},m(l,a){F(l,e,a),i(e,t)},p(l,a){a&8&&fe(t,l[3])},d(l){l&&c(e)}}}function Pe(r){let e;function t(f,h){return f[0]!==""?Fe:qe}let l=t(r),a=l(r);return{c(){e=d("div"),a.c(),this.h()},l(f){e=u(f,"DIV",{class:!0});var h=_(e);a.l(h),h.forEach(c),this.h()},h(){o(e,"class","container-bg w-full h-screen pl-3 pr-3 svelte-rp1h59")},m(f,h){F(f,e,h),a.m(e,null)},p(f,[h]){l===(l=t(f))&&a?a.p(f,h):(a.d(1),a=l(f),a&&(a.c(),a.m(e,null)))},i:se,o:se,d(f){f&&c(e),a.d()}}}const Re="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwbmpsYmpwY2ZlYnFwYXFrcGh5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODg1NDM0NTgsImV4cCI6MjAwNDExOTQ1OH0.CsGySz2c8bIWphE6--T51CsmSeBQajfwvBYfTkjviM4",Ue="https://bpnjlbjpcfebqpaqkphy.supabase.co/functions/v1/token-session-get",Ge="https://bpnjlbjpcfebqpaqkphy.supabase.co/functions/v1/weighted-runtime-roll";function He(r,e,t){let l="",a,f="Loading extension data...",h=0,p="",v="",k=!1,y=[le(1,6),le(1,6)];Ne(async function(){const b=localStorage.getItem("weighted-dice_roll");b!==null&&t(5,y=b.split("").map(j=>parseInt(j)));const m=window.location.hash.substring(1);m!==""&&(l=JSON.parse(decodeURIComponent(m)).mainToken);const g=await fetch(Ue,{method:"POST",headers:{Authorization:`Bearer ${Re}`},body:JSON.stringify({mainToken:l})});if(g.status!==200){console.error(`Error retrieving session data: ${await g.text()}`);return}a=await g.json(),a.regular.nextActionDate!==void 0&&a.role==="wearer"&&await V(),t(0,f="")});let A=-1;function L(b){const m=Math.floor(new Date().getTime()/1e3);if(m<=0)clearInterval(A),t(3,v=""),A=-1;else{const g=Ee(b-m,!0);t(3,v=`Next action in ${g}`)}}function V(){if(a.role!=="keyholder"&&!(a.regular.nextActionDate===null||a.regular.nbActionsRemaining===-1)&&A===-1){const b=Math.floor(new Date().getTime()/1e3),m=Math.floor(new Date(a.regular.nextActionDate).getTime()/1e3);b-m<0&&(L(m),A=setInterval(L,1e3,m))}}async function H(){t(4,k=!0);const b=setInterval(()=>{t(5,y=[le(1,6),le(1,6)])},100),m=await fetch(Ge,{method:"POST",headers:{Authorization:`Bearer ${Re}`},body:JSON.stringify({mainToken:l})});if(m.status!==200){console.error(`Error rolling dice: ${await m.text()}`);return}const[g,j,U]=await m.json();localStorage.setItem("weighted-dice_roll",g.join("")),clearInterval(b),t(5,y=g),t(1,h=j),t(2,p=h===0?"Draw!":(h>0?"Added ":"Removed ")+Ee(Math.abs(h))+"!"),a.role==="wearer"&&(a.regular.nextActionDate=U,V()),t(4,k=!1)}function P(){t(2,p="")}return[f,h,p,v,k,y,H,P]}class et extends Le{constructor(e){super(),ze(this,e,He,Pe,Oe,{})}}export{et as component,$e as universal};
